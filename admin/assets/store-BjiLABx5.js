import{r as D,C as Vs,R as Kr,bt as $,M as Bs,z as Fs,k as Xn,e as js}from"./index-COdFNi2n.js";function te(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=te(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Ys={value:()=>{}};function Ot(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new wt(n)}function wt(e){this._=e}function Xs(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}wt.prototype=Ot.prototype={constructor:wt,on:function(e,t){var n=this._,r=Xs(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=Ws(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=Wn(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Wn(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new wt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function Ws(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Wn(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Ys,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var fn="http://www.w3.org/1999/xhtml";const Gn={svg:"http://www.w3.org/2000/svg",xhtml:fn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ht(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Gn.hasOwnProperty(t)?{space:Gn[t],local:e}:e}function Gs(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===fn&&t.documentElement.namespaceURI===fn?t.createElement(e):t.createElementNS(n,e)}}function qs(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ur(e){var t=Ht(e);return(t.local?qs:Gs)(t)}function Ks(){}function Mn(e){return e==null?Ks:function(){return this.querySelector(e)}}function Us(e){typeof e!="function"&&(e=Mn(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),l,c,u=0;u<s;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new ae(r,this._parents)}function Zs(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Qs(){return[]}function Zr(e){return e==null?Qs:function(){return this.querySelectorAll(e)}}function Js(e){return function(){return Zs(e.apply(this,arguments))}}function ea(e){typeof e=="function"?e=Js(e):e=Zr(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(r.push(e.call(l,l.__data__,c,s)),o.push(l));return new ae(r,o)}function Qr(e){return function(){return this.matches(e)}}function Jr(e){return function(t){return t.matches(e)}}var ta=Array.prototype.find;function na(e){return function(){return ta.call(this.children,e)}}function ra(){return this.firstElementChild}function oa(e){return this.select(e==null?ra:na(typeof e=="function"?e:Jr(e)))}var ia=Array.prototype.filter;function sa(){return Array.from(this.children)}function aa(e){return function(){return ia.call(this.children,e)}}function ca(e){return this.selectAll(e==null?sa:aa(typeof e=="function"?e:Jr(e)))}function ua(e){typeof e!="function"&&(e=Qr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new ae(r,this._parents)}function eo(e){return new Array(e.length)}function la(){return new ae(this._enter||this._groups.map(eo),this._parents)}function St(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}St.prototype={constructor:St,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function da(e){return function(){return e}}function fa(e,t,n,r,o,i){for(var s=0,a,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new St(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function ha(e,t,n,r,o,i,s){var a,l,c=new Map,u=t.length,f=i.length,d=new Array(u),h;for(a=0;a<u;++a)(l=t[a])&&(d[a]=h=s.call(l,l.__data__,a,t)+"",c.has(h)?o[a]=l:c.set(h,l));for(a=0;a<f;++a)h=s.call(e,i[a],a,i)+"",(l=c.get(h))?(r[a]=l,l.__data__=i[a],c.delete(h)):n[a]=new St(e,i[a]);for(a=0;a<u;++a)(l=t[a])&&c.get(d[a])===l&&(o[a]=l)}function ga(e){return e.__data__}function pa(e,t){if(!arguments.length)return Array.from(this,ga);var n=t?ha:fa,r=this._parents,o=this._groups;typeof e!="function"&&(e=da(e));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],f=o[c],d=f.length,h=ma(e.call(u,u&&u.__data__,c,r)),y=h.length,x=a[c]=new Array(y),v=s[c]=new Array(y),w=l[c]=new Array(d);n(u,f,x,v,w,h,t);for(var N=0,p=0,m,M;N<y;++N)if(m=x[N]){for(N>=p&&(p=N+1);!(M=v[p])&&++p<y;);m._next=M||null}}return s=new ae(s,r),s._enter=a,s._exit=l,s}function ma(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ya(){return new ae(this._exit||this._groups.map(eo),this._parents)}function xa(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function wa(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var c=n[l],u=r[l],f=c.length,d=a[l]=new Array(f),h,y=0;y<f;++y)(h=c[y]||u[y])&&(d[y]=h);for(;l<o;++l)a[l]=n[l];return new ae(a,this._parents)}function va(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function _a(e){e||(e=ba);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,l=o[i]=new Array(a),c,u=0;u<a;++u)(c=s[u])&&(l[u]=c);l.sort(t)}return new ae(o,this._parents).order()}function ba(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Sa(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Ea(){return Array.from(this)}function Na(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Ma(){let e=0;for(const t of this)++e;return e}function Ca(){return!this.node()}function $a(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function Ia(e){return function(){this.removeAttribute(e)}}function Aa(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ka(e,t){return function(){this.setAttribute(e,t)}}function Ta(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Da(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Ra(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function La(e,t){var n=Ht(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Aa:Ia:typeof t=="function"?n.local?Ra:Da:n.local?Ta:ka)(n,t))}function to(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function za(e){return function(){this.style.removeProperty(e)}}function Oa(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ha(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Pa(e,t,n){return arguments.length>1?this.each((t==null?za:typeof t=="function"?Ha:Oa)(e,t,n??"")):ze(this.node(),e)}function ze(e,t){return e.style.getPropertyValue(t)||to(e).getComputedStyle(e,null).getPropertyValue(t)}function Va(e){return function(){delete this[e]}}function Ba(e,t){return function(){this[e]=t}}function Fa(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ja(e,t){return arguments.length>1?this.each((t==null?Va:typeof t=="function"?Fa:Ba)(e,t)):this.node()[e]}function no(e){return e.trim().split(/^|\s+/)}function Cn(e){return e.classList||new ro(e)}function ro(e){this._node=e,this._names=no(e.getAttribute("class")||"")}ro.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function oo(e,t){for(var n=Cn(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function io(e,t){for(var n=Cn(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Ya(e){return function(){oo(this,e)}}function Xa(e){return function(){io(this,e)}}function Wa(e,t){return function(){(t.apply(this,arguments)?oo:io)(this,e)}}function Ga(e,t){var n=no(e+"");if(arguments.length<2){for(var r=Cn(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Wa:t?Ya:Xa)(n,t))}function qa(){this.textContent=""}function Ka(e){return function(){this.textContent=e}}function Ua(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Za(e){return arguments.length?this.each(e==null?qa:(typeof e=="function"?Ua:Ka)(e)):this.node().textContent}function Qa(){this.innerHTML=""}function Ja(e){return function(){this.innerHTML=e}}function ec(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function tc(e){return arguments.length?this.each(e==null?Qa:(typeof e=="function"?ec:Ja)(e)):this.node().innerHTML}function nc(){this.nextSibling&&this.parentNode.appendChild(this)}function rc(){return this.each(nc)}function oc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ic(){return this.each(oc)}function sc(e){var t=typeof e=="function"?e:Ur(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ac(){return null}function cc(e,t){var n=typeof e=="function"?e:Ur(e),r=t==null?ac:typeof t=="function"?t:Mn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function uc(){var e=this.parentNode;e&&e.removeChild(this)}function lc(){return this.each(uc)}function dc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function hc(e){return this.select(e?fc:dc)}function gc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function pc(e){return function(t){e.call(this,t,this.__data__)}}function mc(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function yc(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function xc(e,t,n){return function(){var r=this.__on,o,i=pc(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function wc(e,t,n){var r=mc(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(o=0,u=a[l];o<i;++o)if((s=r[o]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?xc:yc,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function so(e,t,n){var r=to(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function vc(e,t){return function(){return so(this,e,t)}}function _c(e,t){return function(){return so(this,e,t.apply(this,arguments))}}function bc(e,t){return this.each((typeof t=="function"?_c:vc)(e,t))}function*Sc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var ao=[null];function ae(e,t){this._groups=e,this._parents=t}function rt(){return new ae([[document.documentElement]],ao)}function Ec(){return this}ae.prototype=rt.prototype={constructor:ae,select:Us,selectAll:ea,selectChild:oa,selectChildren:ca,filter:ua,data:pa,enter:la,exit:ya,join:xa,merge:wa,selection:Ec,order:va,sort:_a,call:Sa,nodes:Ea,node:Na,size:Ma,empty:Ca,each:$a,attr:La,style:Pa,property:ja,classed:Ga,text:Za,html:tc,raise:rc,lower:ic,append:sc,insert:cc,remove:lc,clone:hc,datum:gc,on:wc,dispatch:bc,[Symbol.iterator]:Sc};function se(e){return typeof e=="string"?new ae([[document.querySelector(e)]],[document.documentElement]):new ae([[e]],ao)}function Nc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ce(e,t){if(e=Nc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Mc={passive:!1},qe={capture:!0,passive:!1};function nn(e){e.stopImmediatePropagation()}function Re(e){e.preventDefault(),e.stopImmediatePropagation()}function co(e){var t=e.document.documentElement,n=se(e).on("dragstart.drag",Re,qe);"onselectstart"in t?n.on("selectstart.drag",Re,qe):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function uo(e,t){var n=e.document.documentElement,r=se(e).on("dragstart.drag",null);t&&(r.on("click.drag",Re,qe),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const ut=e=>()=>e;function hn(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}hn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Cc(e){return!e.ctrlKey&&!e.button}function $c(){return this.parentNode}function Ic(e,t){return t??{x:e.x,y:e.y}}function Ac(){return navigator.maxTouchPoints||"ontouchstart"in this}function lo(){var e=Cc,t=$c,n=Ic,r=Ac,o={},i=Ot("start","drag","end"),s=0,a,l,c,u,f=0;function d(m){m.on("mousedown.drag",h).filter(r).on("touchstart.drag",v).on("touchmove.drag",w,Mc).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(m,M){if(!(u||!e.call(this,m,M))){var b=p(this,t.call(this,m,M),m,M,"mouse");b&&(se(m.view).on("mousemove.drag",y,qe).on("mouseup.drag",x,qe),co(m.view),nn(m),c=!1,a=m.clientX,l=m.clientY,b("start",m))}}function y(m){if(Re(m),!c){var M=m.clientX-a,b=m.clientY-l;c=M*M+b*b>f}o.mouse("drag",m)}function x(m){se(m.view).on("mousemove.drag mouseup.drag",null),uo(m.view,c),Re(m),o.mouse("end",m)}function v(m,M){if(e.call(this,m,M)){var b=m.changedTouches,I=t.call(this,m,M),E=b.length,k,L;for(k=0;k<E;++k)(L=p(this,I,m,M,b[k].identifier,b[k]))&&(nn(m),L("start",m,b[k]))}}function w(m){var M=m.changedTouches,b=M.length,I,E;for(I=0;I<b;++I)(E=o[M[I].identifier])&&(Re(m),E("drag",m,M[I]))}function N(m){var M=m.changedTouches,b=M.length,I,E;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),I=0;I<b;++I)(E=o[M[I].identifier])&&(nn(m),E("end",m,M[I]))}function p(m,M,b,I,E,k){var L=i.copy(),z=ce(k||b,M),R,H,g;if((g=n.call(m,new hn("beforestart",{sourceEvent:b,target:d,identifier:E,active:s,x:z[0],y:z[1],dx:0,dy:0,dispatch:L}),I))!=null)return R=g.x-z[0]||0,H=g.y-z[1]||0,function S(_,T,A){var C=z,O;switch(_){case"start":o[E]=S,O=s++;break;case"end":delete o[E],--s;case"drag":z=ce(A||T,M),O=s;break}L.call(_,m,new hn(_,{sourceEvent:T,subject:g,target:d,identifier:E,active:O,x:z[0]+R,y:z[1]+H,dx:z[0]-C[0],dy:z[1]-C[1],dispatch:L}),I)}}return d.filter=function(m){return arguments.length?(e=typeof m=="function"?m:ut(!!m),d):e},d.container=function(m){return arguments.length?(t=typeof m=="function"?m:ut(m),d):t},d.subject=function(m){return arguments.length?(n=typeof m=="function"?m:ut(m),d):n},d.touchable=function(m){return arguments.length?(r=typeof m=="function"?m:ut(!!m),d):r},d.on=function(){var m=i.on.apply(i,arguments);return m===i?d:m},d.clickDistance=function(m){return arguments.length?(f=(m=+m)*m,d):Math.sqrt(f)},d}function $n(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function fo(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ot(){}var Ke=.7,Et=1/Ke,Le="\\s*([+-]?\\d+)\\s*",Ue="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kc=/^#([0-9a-f]{3,8})$/,Tc=new RegExp(`^rgb\\(${Le},${Le},${Le}\\)$`),Dc=new RegExp(`^rgb\\(${fe},${fe},${fe}\\)$`),Rc=new RegExp(`^rgba\\(${Le},${Le},${Le},${Ue}\\)$`),Lc=new RegExp(`^rgba\\(${fe},${fe},${fe},${Ue}\\)$`),zc=new RegExp(`^hsl\\(${Ue},${fe},${fe}\\)$`),Oc=new RegExp(`^hsla\\(${Ue},${fe},${fe},${Ue}\\)$`),qn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$n(ot,Ze,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Kn,formatHex:Kn,formatHex8:Hc,formatHsl:Pc,formatRgb:Un,toString:Un});function Kn(){return this.rgb().formatHex()}function Hc(){return this.rgb().formatHex8()}function Pc(){return ho(this).formatHsl()}function Un(){return this.rgb().formatRgb()}function Ze(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=kc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Zn(t):n===3?new oe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?lt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?lt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Tc.exec(e))?new oe(t[1],t[2],t[3],1):(t=Dc.exec(e))?new oe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Rc.exec(e))?lt(t[1],t[2],t[3],t[4]):(t=Lc.exec(e))?lt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=zc.exec(e))?er(t[1],t[2]/100,t[3]/100,1):(t=Oc.exec(e))?er(t[1],t[2]/100,t[3]/100,t[4]):qn.hasOwnProperty(e)?Zn(qn[e]):e==="transparent"?new oe(NaN,NaN,NaN,0):null}function Zn(e){return new oe(e>>16&255,e>>8&255,e&255,1)}function lt(e,t,n,r){return r<=0&&(e=t=n=NaN),new oe(e,t,n,r)}function Vc(e){return e instanceof ot||(e=Ze(e)),e?(e=e.rgb(),new oe(e.r,e.g,e.b,e.opacity)):new oe}function gn(e,t,n,r){return arguments.length===1?Vc(e):new oe(e,t,n,r??1)}function oe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}$n(oe,gn,fo(ot,{brighter(e){return e=e==null?Et:Math.pow(Et,e),new oe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ke:Math.pow(Ke,e),new oe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new oe(Ce(this.r),Ce(this.g),Ce(this.b),Nt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qn,formatHex:Qn,formatHex8:Bc,formatRgb:Jn,toString:Jn}));function Qn(){return`#${Me(this.r)}${Me(this.g)}${Me(this.b)}`}function Bc(){return`#${Me(this.r)}${Me(this.g)}${Me(this.b)}${Me((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jn(){const e=Nt(this.opacity);return`${e===1?"rgb(":"rgba("}${Ce(this.r)}, ${Ce(this.g)}, ${Ce(this.b)}${e===1?")":`, ${e})`}`}function Nt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ce(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Me(e){return e=Ce(e),(e<16?"0":"")+e.toString(16)}function er(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ue(e,t,n,r)}function ho(e){if(e instanceof ue)return new ue(e.h,e.s,e.l,e.opacity);if(e instanceof ot||(e=Ze(e)),!e)return new ue;if(e instanceof ue)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new ue(s,a,l,e.opacity)}function Fc(e,t,n,r){return arguments.length===1?ho(e):new ue(e,t,n,r??1)}function ue(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}$n(ue,Fc,fo(ot,{brighter(e){return e=e==null?Et:Math.pow(Et,e),new ue(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ke:Math.pow(Ke,e),new ue(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new oe(rn(e>=240?e-240:e+120,o,r),rn(e,o,r),rn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new ue(tr(this.h),dt(this.s),dt(this.l),Nt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Nt(this.opacity);return`${e===1?"hsl(":"hsla("}${tr(this.h)}, ${dt(this.s)*100}%, ${dt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function tr(e){return e=(e||0)%360,e<0?e+360:e}function dt(e){return Math.max(0,Math.min(1,e||0))}function rn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const go=e=>()=>e;function jc(e,t){return function(n){return e+n*t}}function Yc(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Xc(e){return(e=+e)==1?po:function(t,n){return n-t?Yc(t,n,e):go(isNaN(t)?n:t)}}function po(e,t){var n=t-e;return n?jc(e,n):go(isNaN(e)?t:e)}const nr=function e(t){var n=Xc(t);function r(o,i){var s=n((o=gn(o)).r,(i=gn(i)).r),a=n(o.g,i.g),l=n(o.b,i.b),c=po(o.opacity,i.opacity);return function(u){return o.r=s(u),o.g=a(u),o.b=l(u),o.opacity=c(u),o+""}}return r.gamma=e,r}(1);function be(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var pn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(pn.source,"g");function Wc(e){return function(){return e}}function Gc(e){return function(t){return e(t)+""}}function qc(e,t){var n=pn.lastIndex=on.lastIndex=0,r,o,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=pn.exec(e))&&(o=on.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:be(r,o)})),n=on.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?Gc(l[0].x):Wc(t):(t=l.length,function(c){for(var u=0,f;u<t;++u)a[(f=l[u]).i]=f.x(c);return a.join("")})}var rr=180/Math.PI,mn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mo(e,t,n,r,o,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*rr,skewX:Math.atan(l)*rr,scaleX:s,scaleY:a}}var ft;function Kc(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?mn:mo(t.a,t.b,t.c,t.d,t.e,t.f)}function Uc(e){return e==null||(ft||(ft=document.createElementNS("http://www.w3.org/2000/svg","g")),ft.setAttribute("transform",e),!(e=ft.transform.baseVal.consolidate()))?mn:(e=e.matrix,mo(e.a,e.b,e.c,e.d,e.e,e.f))}function yo(e,t,n,r){function o(c){return c.length?c.pop()+" ":""}function i(c,u,f,d,h,y){if(c!==f||u!==d){var x=h.push("translate(",null,t,null,n);y.push({i:x-4,x:be(c,f)},{i:x-2,x:be(u,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function s(c,u,f,d){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),d.push({i:f.push(o(f)+"rotate(",null,r)-2,x:be(c,u)})):u&&f.push(o(f)+"rotate("+u+r)}function a(c,u,f,d){c!==u?d.push({i:f.push(o(f)+"skewX(",null,r)-2,x:be(c,u)}):u&&f.push(o(f)+"skewX("+u+r)}function l(c,u,f,d,h,y){if(c!==f||u!==d){var x=h.push(o(h)+"scale(",null,",",null,")");y.push({i:x-4,x:be(c,f)},{i:x-2,x:be(u,d)})}else(f!==1||d!==1)&&h.push(o(h)+"scale("+f+","+d+")")}return function(c,u){var f=[],d=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,f,d),s(c.rotate,u.rotate,f,d),a(c.skewX,u.skewX,f,d),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,d),c=u=null,function(h){for(var y=-1,x=d.length,v;++y<x;)f[(v=d[y]).i]=v.x(h);return f.join("")}}}var Zc=yo(Kc,"px, ","px)","deg)"),Qc=yo(Uc,", ",")",")"),Jc=1e-12;function or(e){return((e=Math.exp(e))+1/e)/2}function eu(e){return((e=Math.exp(e))-1/e)/2}function tu(e){return((e=Math.exp(2*e))-1)/(e+1)}const nu=function e(t,n,r){function o(i,s){var a=i[0],l=i[1],c=i[2],u=s[0],f=s[1],d=s[2],h=u-a,y=f-l,x=h*h+y*y,v,w;if(x<Jc)w=Math.log(d/c)/t,v=function(I){return[a+I*h,l+I*y,c*Math.exp(t*I*w)]};else{var N=Math.sqrt(x),p=(d*d-c*c+r*x)/(2*c*n*N),m=(d*d-c*c-r*x)/(2*d*n*N),M=Math.log(Math.sqrt(p*p+1)-p),b=Math.log(Math.sqrt(m*m+1)-m);w=(b-M)/t,v=function(I){var E=I*w,k=or(M),L=c/(n*N)*(k*tu(t*E+M)-eu(M));return[a+L*h,l+L*y,c*k/or(t*E+M)]}}return v.duration=w*1e3*t/Math.SQRT2,v}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},o}(Math.SQRT2,2,4);var Oe=0,Ye=0,Fe=0,xo=1e3,Mt,Xe,Ct=0,Ie=0,Pt=0,Qe=typeof performance=="object"&&performance.now?performance:Date,wo=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function In(){return Ie||(wo(ru),Ie=Qe.now()+Pt)}function ru(){Ie=0}function $t(){this._call=this._time=this._next=null}$t.prototype=vo.prototype={constructor:$t,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?In():+n)+(t==null?0:+t),!this._next&&Xe!==this&&(Xe?Xe._next=this:Mt=this,Xe=this),this._call=e,this._time=n,yn()},stop:function(){this._call&&(this._call=null,this._time=1/0,yn())}};function vo(e,t,n){var r=new $t;return r.restart(e,t,n),r}function ou(){In(),++Oe;for(var e=Mt,t;e;)(t=Ie-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Oe}function ir(){Ie=(Ct=Qe.now())+Pt,Oe=Ye=0;try{ou()}finally{Oe=0,su(),Ie=0}}function iu(){var e=Qe.now(),t=e-Ct;t>xo&&(Pt-=t,Ct=e)}function su(){for(var e,t=Mt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Mt=n);Xe=e,yn(r)}function yn(e){if(!Oe){Ye&&(Ye=clearTimeout(Ye));var t=e-Ie;t>24?(e<1/0&&(Ye=setTimeout(ir,e-Qe.now()-Pt)),Fe&&(Fe=clearInterval(Fe))):(Fe||(Ct=Qe.now(),Fe=setInterval(iu,xo)),Oe=1,wo(ir))}}function sr(e,t,n){var r=new $t;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var au=Ot("start","end","cancel","interrupt"),cu=[],_o=0,ar=1,xn=2,vt=3,cr=4,wn=5,_t=6;function Vt(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;uu(e,n,{name:t,index:r,group:o,on:au,tween:cu,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:_o})}function An(e,t){var n=le(e,t);if(n.state>_o)throw new Error("too late; already scheduled");return n}function he(e,t){var n=le(e,t);if(n.state>vt)throw new Error("too late; already running");return n}function le(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function uu(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=vo(i,0,n.time);function i(c){n.state=ar,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var u,f,d,h;if(n.state!==ar)return l();for(u in r)if(h=r[u],h.name===n.name){if(h.state===vt)return sr(s);h.state===cr?(h.state=_t,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=_t,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(sr(function(){n.state===vt&&(n.state=cr,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=xn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===xn){for(n.state=vt,o=new Array(d=n.tween.length),u=0,f=-1;u<d;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=h);o.length=f+1}}function a(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=wn,1),f=-1,d=o.length;++f<d;)o[f].call(e,u);n.state===wn&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=_t,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function bt(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>xn&&r.state<wn,r.state=_t,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function lu(e){return this.each(function(){bt(this,e)})}function du(e,t){var n,r;return function(){var o=he(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function fu(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=he(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=a;break}l===c&&o.push(a)}i.tween=o}}function hu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=le(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?du:fu)(n,e,t))}function kn(e,t,n){var r=e._id;return e.each(function(){var o=he(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return le(o,r).value[t]}}function bo(e,t){var n;return(typeof t=="number"?be:t instanceof Ze?nr:(n=Ze(t))?(t=n,nr):qc)(e,t)}function gu(e){return function(){this.removeAttribute(e)}}function pu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function mu(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function yu(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function xu(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function wu(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function vu(e,t){var n=Ht(e),r=n==="transform"?Qc:bo;return this.attrTween(e,typeof t=="function"?(n.local?wu:xu)(n,r,kn(this,"attr."+e,t)):t==null?(n.local?pu:gu)(n):(n.local?yu:mu)(n,r,t))}function _u(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function bu(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Su(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&bu(e,i)),n}return o._value=t,o}function Eu(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&_u(e,i)),n}return o._value=t,o}function Nu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Ht(e);return this.tween(n,(r.local?Su:Eu)(r,t))}function Mu(e,t){return function(){An(this,e).delay=+t.apply(this,arguments)}}function Cu(e,t){return t=+t,function(){An(this,e).delay=t}}function $u(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Mu:Cu)(t,e)):le(this.node(),t).delay}function Iu(e,t){return function(){he(this,e).duration=+t.apply(this,arguments)}}function Au(e,t){return t=+t,function(){he(this,e).duration=t}}function ku(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Iu:Au)(t,e)):le(this.node(),t).duration}function Tu(e,t){if(typeof t!="function")throw new Error;return function(){he(this,e).ease=t}}function Du(e){var t=this._id;return arguments.length?this.each(Tu(t,e)):le(this.node(),t).ease}function Ru(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;he(this,e).ease=n}}function Lu(e){if(typeof e!="function")throw new Error;return this.each(Ru(this._id,e))}function zu(e){typeof e!="function"&&(e=Qr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new xe(r,this._parents,this._name,this._id)}function Ou(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l=t[a],c=n[a],u=l.length,f=s[a]=new Array(u),d,h=0;h<u;++h)(d=l[h]||c[h])&&(f[h]=d);for(;a<r;++a)s[a]=t[a];return new xe(s,this._parents,this._name,this._id)}function Hu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Pu(e,t,n){var r,o,i=Hu(t)?An:he;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function Vu(e,t){var n=this._id;return arguments.length<2?le(this.node(),n).on.on(e):this.each(Pu(n,e,t))}function Bu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Fu(){return this.on("end.remove",Bu(this._id))}function ju(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Mn(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],l=a.length,c=i[s]=new Array(l),u,f,d=0;d<l;++d)(u=a[d])&&(f=e.call(u,u.__data__,d,a))&&("__data__"in u&&(f.__data__=u.__data__),c[d]=f,Vt(c[d],t,n,d,c,le(u,n)));return new xe(i,this._parents,t,n)}function Yu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Zr(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l=r[a],c=l.length,u,f=0;f<c;++f)if(u=l[f]){for(var d=e.call(u,u.__data__,f,l),h,y=le(u,n),x=0,v=d.length;x<v;++x)(h=d[x])&&Vt(h,t,n,x,d,y);i.push(d),s.push(u)}return new xe(i,s,t,n)}var Xu=rt.prototype.constructor;function Wu(){return new Xu(this._groups,this._parents)}function Gu(e,t){var n,r,o;return function(){var i=ze(this,e),s=(this.style.removeProperty(e),ze(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function So(e){return function(){this.style.removeProperty(e)}}function qu(e,t,n){var r,o=n+"",i;return function(){var s=ze(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function Ku(e,t,n){var r,o,i;return function(){var s=ze(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),ze(this,e))),s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a))}}function Uu(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var l=he(this,e),c=l.on,u=l.value[i]==null?a||(a=So(t)):void 0;(c!==n||o!==u)&&(r=(n=c).copy()).on(s,o=u),l.on=r}}function Zu(e,t,n){var r=(e+="")=="transform"?Zc:bo;return t==null?this.styleTween(e,Gu(e,r)).on("end.style."+e,So(e)):typeof t=="function"?this.styleTween(e,Ku(e,r,kn(this,"style."+e,t))).each(Uu(this._id,e)):this.styleTween(e,qu(e,r,t),n).on("end.style."+e,null)}function Qu(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Ju(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&Qu(e,s,n)),r}return i._value=t,i}function el(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Ju(e,t,n??""))}function tl(e){return function(){this.textContent=e}}function nl(e){return function(){var t=e(this);this.textContent=t??""}}function rl(e){return this.tween("text",typeof e=="function"?nl(kn(this,"text",e)):tl(e==null?"":e+""))}function ol(e){return function(t){this.textContent=e.call(this,t)}}function il(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&ol(o)),t}return r._value=e,r}function sl(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,il(e))}function al(){for(var e=this._name,t=this._id,n=Eo(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var u=le(l,t);Vt(l,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new xe(r,this._parents,e,n)}function cl(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--o===0&&i()}};n.each(function(){var c=he(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),o===0&&i()})}var ul=0;function xe(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Eo(){return++ul}var pe=rt.prototype;xe.prototype={constructor:xe,select:ju,selectAll:Yu,selectChild:pe.selectChild,selectChildren:pe.selectChildren,filter:zu,merge:Ou,selection:Wu,transition:al,call:pe.call,nodes:pe.nodes,node:pe.node,size:pe.size,empty:pe.empty,each:pe.each,on:Vu,attr:vu,attrTween:Nu,style:Zu,styleTween:el,text:rl,textTween:sl,remove:Fu,tween:hu,delay:$u,duration:ku,ease:Du,easeVarying:Lu,end:cl,[Symbol.iterator]:pe[Symbol.iterator]};function ll(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var dl={time:null,delay:0,duration:250,ease:ll};function fl(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function hl(e){var t,n;e instanceof xe?(t=e._id,e=e._name):(t=Eo(),(n=dl).time=In(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&Vt(l,e,t,c,s,n||fl(l,t));return new xe(r,this._parents,e,t)}rt.prototype.interrupt=lu;rt.prototype.transition=hl;const ht=e=>()=>e;function gl(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function me(e,t,n){this.k=e,this.x=t,this.y=n}me.prototype={constructor:me,scale:function(e){return e===1?this:new me(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new me(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Bt=new me(1,0,0);No.prototype=me.prototype;function No(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Bt;return e.__zoom}function sn(e){e.stopImmediatePropagation()}function je(e){e.preventDefault(),e.stopImmediatePropagation()}function pl(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function ml(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ur(){return this.__zoom||Bt}function yl(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function xl(){return navigator.maxTouchPoints||"ontouchstart"in this}function wl(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Mo(){var e=pl,t=ml,n=wl,r=yl,o=xl,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=nu,c=Ot("start","zoom","end"),u,f,d,h=500,y=150,x=0,v=10;function w(g){g.property("__zoom",ur).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",L).filter(o).on("touchstart.zoom",z).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(g,S,_,T){var A=g.selection?g.selection():g;A.property("__zoom",ur),g!==A?M(g,S,_,T):A.interrupt().each(function(){b(this,arguments).event(T).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},w.scaleBy=function(g,S,_,T){w.scaleTo(g,function(){var A=this.__zoom.k,C=typeof S=="function"?S.apply(this,arguments):S;return A*C},_,T)},w.scaleTo=function(g,S,_,T){w.transform(g,function(){var A=t.apply(this,arguments),C=this.__zoom,O=_==null?m(A):typeof _=="function"?_.apply(this,arguments):_,P=C.invert(O),V=typeof S=="function"?S.apply(this,arguments):S;return n(p(N(C,V),O,P),A,s)},_,T)},w.translateBy=function(g,S,_,T){w.transform(g,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof _=="function"?_.apply(this,arguments):_),t.apply(this,arguments),s)},null,T)},w.translateTo=function(g,S,_,T,A){w.transform(g,function(){var C=t.apply(this,arguments),O=this.__zoom,P=T==null?m(C):typeof T=="function"?T.apply(this,arguments):T;return n(Bt.translate(P[0],P[1]).scale(O.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof _=="function"?-_.apply(this,arguments):-_),C,s)},T,A)};function N(g,S){return S=Math.max(i[0],Math.min(i[1],S)),S===g.k?g:new me(S,g.x,g.y)}function p(g,S,_){var T=S[0]-_[0]*g.k,A=S[1]-_[1]*g.k;return T===g.x&&A===g.y?g:new me(g.k,T,A)}function m(g){return[(+g[0][0]+ +g[1][0])/2,(+g[0][1]+ +g[1][1])/2]}function M(g,S,_,T){g.on("start.zoom",function(){b(this,arguments).event(T).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(T).end()}).tween("zoom",function(){var A=this,C=arguments,O=b(A,C).event(T),P=t.apply(A,C),V=_==null?m(P):typeof _=="function"?_.apply(A,C):_,B=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),F=A.__zoom,Y=typeof S=="function"?S.apply(A,C):S,G=l(F.invert(V).concat(B/F.k),Y.invert(V).concat(B/Y.k));return function(q){if(q===1)q=Y;else{var K=G(q),J=B/K[2];q=new me(J,V[0]-K[0]*J,V[1]-K[1]*J)}O.zoom(null,q)}})}function b(g,S,_){return!_&&g.__zooming||new I(g,S)}function I(g,S){this.that=g,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(g,S),this.taps=0}I.prototype={event:function(g){return g&&(this.sourceEvent=g),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(g,S){return this.mouse&&g!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&g!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&g!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(g){var S=se(this.that).datum();c.call(g,this.that,new gl(g,{sourceEvent:this.sourceEvent,target:w,type:g,transform:this.that.__zoom,dispatch:c}),S)}};function E(g,...S){if(!e.apply(this,arguments))return;var _=b(this,S).event(g),T=this.__zoom,A=Math.max(i[0],Math.min(i[1],T.k*Math.pow(2,r.apply(this,arguments)))),C=ce(g);if(_.wheel)(_.mouse[0][0]!==C[0]||_.mouse[0][1]!==C[1])&&(_.mouse[1]=T.invert(_.mouse[0]=C)),clearTimeout(_.wheel);else{if(T.k===A)return;_.mouse=[C,T.invert(C)],bt(this),_.start()}je(g),_.wheel=setTimeout(O,y),_.zoom("mouse",n(p(N(T,A),_.mouse[0],_.mouse[1]),_.extent,s));function O(){_.wheel=null,_.end()}}function k(g,...S){if(d||!e.apply(this,arguments))return;var _=g.currentTarget,T=b(this,S,!0).event(g),A=se(g.view).on("mousemove.zoom",V,!0).on("mouseup.zoom",B,!0),C=ce(g,_),O=g.clientX,P=g.clientY;co(g.view),sn(g),T.mouse=[C,this.__zoom.invert(C)],bt(this),T.start();function V(F){if(je(F),!T.moved){var Y=F.clientX-O,G=F.clientY-P;T.moved=Y*Y+G*G>x}T.event(F).zoom("mouse",n(p(T.that.__zoom,T.mouse[0]=ce(F,_),T.mouse[1]),T.extent,s))}function B(F){A.on("mousemove.zoom mouseup.zoom",null),uo(F.view,T.moved),je(F),T.event(F).end()}}function L(g,...S){if(e.apply(this,arguments)){var _=this.__zoom,T=ce(g.changedTouches?g.changedTouches[0]:g,this),A=_.invert(T),C=_.k*(g.shiftKey?.5:2),O=n(p(N(_,C),T,A),t.apply(this,S),s);je(g),a>0?se(this).transition().duration(a).call(M,O,T,g):se(this).call(w.transform,O,T,g)}}function z(g,...S){if(e.apply(this,arguments)){var _=g.touches,T=_.length,A=b(this,S,g.changedTouches.length===T).event(g),C,O,P,V;for(sn(g),O=0;O<T;++O)P=_[O],V=ce(P,this),V=[V,this.__zoom.invert(V),P.identifier],A.touch0?!A.touch1&&A.touch0[2]!==V[2]&&(A.touch1=V,A.taps=0):(A.touch0=V,C=!0,A.taps=1+!!u);u&&(u=clearTimeout(u)),C&&(A.taps<2&&(f=V[0],u=setTimeout(function(){u=null},h)),bt(this),A.start())}}function R(g,...S){if(this.__zooming){var _=b(this,S).event(g),T=g.changedTouches,A=T.length,C,O,P,V;for(je(g),C=0;C<A;++C)O=T[C],P=ce(O,this),_.touch0&&_.touch0[2]===O.identifier?_.touch0[0]=P:_.touch1&&_.touch1[2]===O.identifier&&(_.touch1[0]=P);if(O=_.that.__zoom,_.touch1){var B=_.touch0[0],F=_.touch0[1],Y=_.touch1[0],G=_.touch1[1],q=(q=Y[0]-B[0])*q+(q=Y[1]-B[1])*q,K=(K=G[0]-F[0])*K+(K=G[1]-F[1])*K;O=N(O,Math.sqrt(q/K)),P=[(B[0]+Y[0])/2,(B[1]+Y[1])/2],V=[(F[0]+G[0])/2,(F[1]+G[1])/2]}else if(_.touch0)P=_.touch0[0],V=_.touch0[1];else return;_.zoom("touch",n(p(O,P,V),_.extent,s))}}function H(g,...S){if(this.__zooming){var _=b(this,S).event(g),T=g.changedTouches,A=T.length,C,O;for(sn(g),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),C=0;C<A;++C)O=T[C],_.touch0&&_.touch0[2]===O.identifier?delete _.touch0:_.touch1&&_.touch1[2]===O.identifier&&delete _.touch1;if(_.touch1&&!_.touch0&&(_.touch0=_.touch1,delete _.touch1),_.touch0)_.touch0[1]=this.__zoom.invert(_.touch0[0]);else if(_.end(),_.taps===2&&(O=ce(O,this),Math.hypot(f[0]-O[0],f[1]-O[1])<v)){var P=se(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return w.wheelDelta=function(g){return arguments.length?(r=typeof g=="function"?g:ht(+g),w):r},w.filter=function(g){return arguments.length?(e=typeof g=="function"?g:ht(!!g),w):e},w.touchable=function(g){return arguments.length?(o=typeof g=="function"?g:ht(!!g),w):o},w.extent=function(g){return arguments.length?(t=typeof g=="function"?g:ht([[+g[0][0],+g[0][1]],[+g[1][0],+g[1][1]]]),w):t},w.scaleExtent=function(g){return arguments.length?(i[0]=+g[0],i[1]=+g[1],w):[i[0],i[1]]},w.translateExtent=function(g){return arguments.length?(s[0][0]=+g[0][0],s[1][0]=+g[1][0],s[0][1]=+g[0][1],s[1][1]=+g[1][1],w):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},w.constrain=function(g){return arguments.length?(n=g,w):n},w.duration=function(g){return arguments.length?(a=+g,w):a},w.interpolate=function(g){return arguments.length?(l=g,w):l},w.on=function(){var g=c.on.apply(c,arguments);return g===c?w:g},w.clickDistance=function(g){return arguments.length?(x=(g=+g)*g,w):Math.sqrt(x)},w.tapDistance=function(g){return arguments.length?(v=+g,w):v},w}const ie={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${n&&r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`},It=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Co=["Enter"," ","Escape"];var Ae;(function(e){e.Strict="strict",e.Loose="loose"})(Ae||(Ae={}));var $e;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})($e||($e={}));var Je;(function(e){e.Partial="partial",e.Full="full"})(Je||(Je={}));var Se;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Se||(Se={}));var At;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(At||(At={}));var j;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(j||(j={}));const vl=e=>"id"in e&&"source"in e&&"target"in e,_l=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),bl=(e,t,n)=>{if(!e.id)return[];const r=new Set;return n.forEach(o=>{o.target===e.id&&r.add(o.source)}),t.filter(o=>r.has(o.id))},Pe=(e,t=[0,0])=>{const{width:n,height:r}=it(e),o="internals"in e?e.internals.positionAbsolute:e.position,i=e.origin||t,s=n*i[0],a=r*i[1];return{position:{x:e.position.x-s,y:e.position.y-a},positionAbsolute:{x:o.x-s,y:o.y-a}}},Sl=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const i=kt(o,t.nodeOrigin);return jt(r,i)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Yt(n)},Ft=(e,t={nodeOrigin:[0,0]})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter==null||t.filter(r)){const o=kt(r,t.nodeOrigin);n=jt(n,o)}}),Yt(n)},$o=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1,a=[0,0])=>{const l={...Wt(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const[,u]of e){const{measured:f,selectable:d=!0,hidden:h=!1}=u,y=f.width??u.width??u.initialWidth??null,x=f.height??u.height??u.initialHeight??null;if(s&&!d||h)continue;const v=Tt(l,et(u,a)),w=y===null||x===null,N=i&&v>0,p=(y??0)*(x??0);(w||N||v>=p||u.dragging)&&c.push(u)}return c},El=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Io({nodeLookup:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i,nodeOrigin:s=[0,0]},a){const l=[],c=a!=null&&a.nodes?new Set(a.nodes.map(u=>u.id)):null;if(e.forEach(u=>{u.measured.width&&u.measured.height&&((a==null?void 0:a.includeHiddenNodes)||!u.hidden)&&(!c||c.has(u.id))&&l.push(u)}),l.length>0){const u=Sl(l,{nodeOrigin:s}),f=Dn(u,t,n,(a==null?void 0:a.minZoom)??o,(a==null?void 0:a.maxZoom)??i,(a==null?void 0:a.padding)??.1);return r.setViewport(f,{duration:a==null?void 0:a.duration}),!0}return!1}function Nl(e,t){var n,r;return!t||t==="parent"?t:[t[0],[t[1][0]-(((n=e.measured)==null?void 0:n.width)??0),t[1][1]-(((r=e.measured)==null?void 0:r.height)??0)]]}function Ao({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:c}=a?Pe(a,a.origin||r).positionAbsolute:{x:0,y:0};let u=Nl(s,s.extent||o);if(s.extent==="parent"&&!s.expandParent)if(!a)i==null||i("005",ie.error005());else{const d=s.measured.width,h=s.measured.height,y=a.measured.width,x=a.measured.height;if(d&&h&&y&&x){const v=s.origin||r,w=l+d*v[0],N=c+h*v[1];u=[[w,N],[w+y-d,N+x-h]]}}else a&&fr(s.extent)&&(u=[[s.extent[0][0]+l,s.extent[0][1]+c],[s.extent[1][0]+l,s.extent[1][1]+c]]);const f=fr(u)?Tn(t,u):t;return{position:{x:f.x-l,y:f.y-c},positionAbsolute:f}}async function Ml({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const i=new Set(e.map(d=>d.id)),s=[];for(const d of n){if(d.deletable===!1)continue;const h=i.has(d.id),y=!h&&d.parentId&&s.find(x=>x.id===d.parentId);(h||y)&&s.push(d)}const a=new Set(t.map(d=>d.id)),l=r.filter(d=>d.deletable!==!1),u=El(s,l);for(const d of l)a.has(d.id)&&!u.find(y=>y.id===d.id)&&u.push(d);if(!o)return{edges:u,nodes:s};const f=await o({nodes:s,edges:u});return typeof f=="boolean"?f?{edges:u,nodes:s}:{edges:[],nodes:[]}:f}const He=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Tn=(e={x:0,y:0},t)=>({x:He(e.x,t[0][0],t[1][0]),y:He(e.y,t[0][1],t[1][1])}),lr=(e,t,n)=>e<t?He(Math.abs(e-t),1,50)/50:e>n?-He(Math.abs(e-n),1,50)/50:0,ko=(e,t)=>{const n=lr(e.x,35,t.width-35)*20,r=lr(e.y,35,t.height-35)*20;return[n,r]},jt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),vn=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Yt=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),et=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=Pe(e,t).positionAbsolute;return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??0,height:((i=e.measured)==null?void 0:i.height)??e.height??0}},kt=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=Pe(e,t).positionAbsolute;return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??0),y2:r+(((i=e.measured)==null?void 0:i.height)??e.height??0)}},To=(e,t)=>Yt(jt(vn(e),vn(t))),Tt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},dr=e=>de(e.width)&&de(e.height)&&de(e.x)&&de(e.y),de=e=>!isNaN(e)&&isFinite(e),Dt=(e,t)=>{console.warn(`[React Flow]: ${t} Help: https://reactflow.dev/error#${e}`)},Cl=({x:e,y:t,width:n,height:r,origin:o=[0,0]})=>!n||!r||o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},Xt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Wt=({x:e,y:t},[n,r,o],i=!1,s=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return i?Xt(a,s):a},Do=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),Dn=(e,t,n,r,o,i)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(s,a),c=He(l,r,o),u=e.x+e.width/2,f=e.y+e.height/2,d=t/2-u*c,h=n/2-f*c;return{x:d,y:h,zoom:c}},Rt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function fr(e){return e!==void 0&&e!=="parent"}function it(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Ro(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Lo(e,t,n,r=[0,0]){let o=t;const i={...e};for(;o;){const s=n.get(t);if(o=s==null?void 0:s.parentId,s){const a=s.origin||r,l=(s.measured.width??0)*a[0],c=(s.measured.height??0)*a[1];i.x+=s.position.x-l,i.y+=s.position.y-c}}return i}function We(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r}){const{x:o,y:i}=ye(e),s=Wt({x:o,y:i},r),{x:a,y:l}=n?Xt(s,t):s;return{xSnapped:a,ySnapped:l,...s}}const Rn=e=>({width:e.offsetWidth,height:e.offsetHeight}),zo=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},$l=["INPUT","SELECT","TEXTAREA"];function _n(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return $l.includes(t==null?void 0:t.nodeName)||(t==null?void 0:t.hasAttribute("contenteditable"))||!!(t!=null&&t.closest(".nokey"))}const Oo=e=>"clientX"in e,ye=(e,t)=>{var i,s;const n=Oo(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},hr=(e,t,n,r=[0,0])=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return i.map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(c.left-s.left-a.x)/n,y:(c.top-s.top-a.y)/n,...Rn(l)}})};function Ho({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=e*.125+o*.375+s*.375+n*.125,c=t*.125+i*.375+a*.375+r*.125,u=Math.abs(l-e),f=Math.abs(c-t);return[l,c,u,f]}function gt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function gr({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case j.Left:return[t-gt(t-r,i),n];case j.Right:return[t+gt(r-t,i),n];case j.Top:return[t,n-gt(n-o,i)];case j.Bottom:return[t,n+gt(o-n,i)]}}function Po({sourceX:e,sourceY:t,sourcePosition:n=j.Bottom,targetX:r,targetY:o,targetPosition:i=j.Top,curvature:s=.25}){const[a,l]=gr({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[c,u]=gr({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[f,d,h,y]=Ho({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${a},${l} ${c},${u} ${r},${o}`,f,d,h,y]}function Vo({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function Il({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const i=n||t.selected||e.selected,s=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(i?s:0)}function Al({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const i=jt(kt(e),kt(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return Tt(s,Yt(i))>0}const Bo=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,kl=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Fo=(e,t)=>{if(!e.source||!e.target)return Dt("006",ie.error006()),t;let n;return vl(e)?n={...e}:n={...e,id:Bo(e)},kl(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))},Tl=(e,t,n,r={shouldReplaceId:!0})=>{const{id:o,...i}=e;if(!t.source||!t.target)return Dt("006",ie.error006()),n;if(!n.find(l=>l.id===e.id))return Dt("007",ie.error007(o)),n;const a={...i,id:r.shouldReplaceId?Bo(t):o,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle};return n.filter(l=>l.id!==o).concat(a)};function Dl({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=Vo({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const pr={[j.Left]:{x:-1,y:0},[j.Right]:{x:1,y:0},[j.Top]:{x:0,y:-1},[j.Bottom]:{x:0,y:1}},Rl=({source:e,sourcePosition:t=j.Bottom,target:n})=>t===j.Left||t===j.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},mr=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Ll({source:e,sourcePosition:t=j.Bottom,target:n,targetPosition:r=j.Top,center:o,offset:i}){const s=pr[t],a=pr[r],l={x:e.x+s.x*i,y:e.y+s.y*i},c={x:n.x+a.x*i,y:n.y+a.y*i},u=Rl({source:l,sourcePosition:t,target:c}),f=u.x!==0?"x":"y",d=u[f];let h=[],y,x;const v={x:0,y:0},w={x:0,y:0},[N,p,m,M]=Vo({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[f]*a[f]===-1){y=o.x??N,x=o.y??p;const I=[{x:y,y:l.y},{x:y,y:c.y}],E=[{x:l.x,y:x},{x:c.x,y:x}];s[f]===d?h=f==="x"?I:E:h=f==="x"?E:I}else{const I=[{x:l.x,y:c.y}],E=[{x:c.x,y:l.y}];if(f==="x"?h=s.x===d?E:I:h=s.y===d?I:E,t===r){const H=Math.abs(e[f]-n[f]);if(H<=i){const g=Math.min(i-1,i-H);s[f]===d?v[f]=(l[f]>e[f]?-1:1)*g:w[f]=(c[f]>n[f]?-1:1)*g}}if(t!==r){const H=f==="x"?"y":"x",g=s[f]===a[H],S=l[H]>c[H],_=l[H]<c[H];(s[f]===1&&(!g&&S||g&&_)||s[f]!==1&&(!g&&_||g&&S))&&(h=f==="x"?I:E)}const k={x:l.x+v.x,y:l.y+v.y},L={x:c.x+w.x,y:c.y+w.y},z=Math.max(Math.abs(k.x-h[0].x),Math.abs(L.x-h[0].x)),R=Math.max(Math.abs(k.y-h[0].y),Math.abs(L.y-h[0].y));z>=R?(y=(k.x+L.x)/2,x=h[0].y):(y=h[0].x,x=(k.y+L.y)/2)}return[[e,{x:l.x+v.x,y:l.y+v.y},...h,{x:c.x+w.x,y:c.y+w.y},n],y,x,m,M]}function zl(e,t,n,r){const o=Math.min(mr(e,t)/2,mr(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const c=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+o*c},${s}Q ${i},${s} ${i},${s+o*u}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+o*l}Q ${i},${s} ${i+o*a},${s}`}function bn({sourceX:e,sourceY:t,sourcePosition:n=j.Bottom,targetX:r,targetY:o,targetPosition:i=j.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20}){const[u,f,d,h,y]=Ll({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:l},offset:c});return[u.reduce((v,w,N)=>{let p="";return N>0&&N<u.length-1?p=zl(u[N-1],w,u[N+1],s):p=`${N===0?"M":"L"}${w.x} ${w.y}`,v+=p,v},""),f,d,h,y]}function yr(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Ol(e){var h;const{sourceNode:t,targetNode:n}=e;if(!yr(t)||!yr(n))return null;const r=t.internals.handleBounds||xr(t.handles),o=n.internals.handleBounds||xr(n.handles),i=vr((r==null?void 0:r.source)??[],e.sourceHandle),s=vr(e.connectionMode===Ae.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle),a=(i==null?void 0:i.position)||j.Bottom,l=(s==null?void 0:s.position)||j.Top;if(!i||!s)return(h=e.onError)==null||h.call(e,"008",ie.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const[c,u]=wr(a,t,i),[f,d]=wr(l,n,s);return{sourceX:c,sourceY:u,targetX:f,targetY:d,sourcePosition:a,targetPosition:l}}function xr(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function wr(e,t,n=null){const r=((n==null?void 0:n.x)??0)+t.internals.positionAbsolute.x,o=((n==null?void 0:n.y)??0)+t.internals.positionAbsolute.y,{width:i,height:s}=n??it(t);switch(e){case j.Top:return[r+i/2,o];case j.Right:return[r+i,o+s/2];case j.Bottom:return[r+i/2,o+s];case j.Left:return[r,o+s/2]}}function vr(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Sn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function Hl(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||r,a.markerEnd||o].forEach(l=>{if(l&&typeof l=="object"){const c=Sn(l,t);i.has(c)||(s.push({id:c,color:l.color||n,...l}),i.add(c))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}function jo(e,t={nodeOrigin:[0,0],elevateNodesOnSelect:!0,defaults:{}}){const n=t!=null&&t.elevateNodesOnSelect?1e3:0;for(const[,r]of e){const o=r.parentId;if(!o)continue;if(!e.has(o))throw new Error(`Parent node ${o} not found`);const i=e.get(o),{x:s,y:a,z:l}=Xo(r,e,{...r.position,z:(de(r.zIndex)?r.zIndex:0)+(r.selected?n:0)},(i==null?void 0:i.origin)??t.nodeOrigin),c=r.internals.positionAbsolute,u=s!==c.x||a!==c.y;(u||l!==r.internals.z)&&(r.internals={...r.internals,positionAbsolute:u?{x:s,y:a}:c,z:l})}}function Yo(e,t,n,r={nodeOrigin:[0,0],elevateNodesOnSelect:!0,defaults:{},checkEquality:!0}){const o=new Map(t);t.clear(),n.clear();const i=r!=null&&r.elevateNodesOnSelect?1e3:0;e.forEach(s=>{var l,c;let a=o.get(s.id);if(r.checkEquality&&s===(a==null?void 0:a.internals.userNode)||(a={...r.defaults,...s,measured:{width:(l=s.measured)==null?void 0:l.width,height:(c=s.measured)==null?void 0:c.height},internals:{positionAbsolute:s.position,handleBounds:a==null?void 0:a.internals.handleBounds,z:(de(s.zIndex)?s.zIndex:0)+(s.selected?i:0),userNode:s}}),t.set(s.id,a),s.parentId){const u=n.get(s.parentId);u?u.push(a):n.set(s.parentId,[a])}}),n.size>0&&jo(t,r)}function Xo(e,t,n,r=[0,0]){if(!e.parentId)return n;const o=t.get(e.parentId),i=Pe(o,r).position;return Xo(o,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(o.internals.z??0)>(n.z??0)?o.internals.z??0:n.z??0},o.origin||r)}function Ln(e,t,n,r){var s;const o=[],i=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const c=((s=i.get(a.parentId))==null?void 0:s.expandedRect)??et(l,l.origin??r),u=To(c,a.rect);i.set(a.parentId,{expandedRect:u,parent:l})}return i.size>0&&i.forEach(({expandedRect:a,parent:l},c)=>{const{position:u}=Pe(l,l.origin),f=it(l),d=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,h=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0;if(d>0||h>0){o.push({id:c,type:"position",position:{x:u.x-d,y:u.y-h}});const y=n.get(c);y==null||y.forEach(x=>{e.some(v=>v.id===x.id)||o.push({id:x.id,type:"position",position:{x:x.position.x+d,y:x.position.y+h}})})}(f.width<a.width||f.height<a.height)&&o.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:Math.max(f.width,Math.round(a.width)),height:Math.max(f.height,Math.round(a.height))}})}),o}function Pl(e,t,n,r,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let s=!1;if(!i)return{changes:[],updatedInternals:s};const a=[],l=window.getComputedStyle(i),{m22:c}=new window.DOMMatrixReadOnly(l.transform),u=[];if(e.forEach(f=>{const d=t.get(f.id);if(d!=null&&d.hidden)d.internals={...d.internals,handleBounds:void 0},s=!0;else if(d){const h=Rn(f.nodeElement),y=d.measured.width!==h.width||d.measured.height!==h.height;!!(h.width&&h.height&&(y||!d.internals.handleBounds||f.force))&&(d.measured=h,d.internals={...d.internals,handleBounds:{source:hr(".source",f.nodeElement,c,d.origin||o),target:hr(".target",f.nodeElement,c,d.origin||o)}},s=!0,y&&(a.push({id:d.id,type:"dimensions",dimensions:h}),d.expandParent&&d.parentId&&u.push({id:d.id,parentId:d.parentId,rect:et(d,o)})))}}),u.length>0){const f=Ln(u,t,n,o);a.push(...f)}return{changes:a,updatedInternals:s}}function Vl({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return!1;const s=t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r);return!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2])}function Wo(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:i,sourceHandle:s=null,targetHandle:a=null}=r,l=`${o}-source-${s}`,c=`${i}-target-${a}`,u=e.get(l)||new Map,f=e.get(c)||new Map,d={edgeId:r.id,source:o,target:i,sourceHandle:s,targetHandle:a};t.set(r.id,r),e.set(l,u.set(`${i}-${a}`,d)),e.set(c,f.set(`${o}-${s}`,d))}}function Bl(e,t){if(e===null||t===null)return!1;const n=Array.isArray(e)?e:[e],r=Array.isArray(t)?t:[t];if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++)if(n[o].id!==r[o].id||n[o].type!==r[o].type||!Object.is(n[o].data,r[o].data))return!1;return!0}function Go(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:Go(n,t):!1}function _r(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n)return!1;r=r.parentElement}while(r);return!1}function Fl(e,t,n,r){const o=new Map;for(const[i,s]of e)if((s.selected||s.id===r)&&(!s.parentId||!Go(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&o.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function an({nodeId:e,dragItems:t,nodeLookup:n}){var i,s;const r=[];for(const[a,l]of t){const c=(i=n.get(a))==null?void 0:i.internals.userNode;c&&r.push({...c,position:l.position})}if(!e)return[r[0],r];const o=n.get(e).internals.userNode;return[{...o,position:((s=t.get(e))==null?void 0:s.position)||o.position},r]}function jl({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},s=0,a=new Map,l=!1,c={x:0,y:0},u=null,f=!1,d=null;function h({noDragClassName:x,handleSelector:v,domNode:w,isSelectable:N,nodeId:p}){d=se(w);function m({x:E,y:k},L){const{nodeLookup:z,nodeExtent:R,snapGrid:H,snapToGrid:g,nodeOrigin:S,onNodeDrag:_,onSelectionDrag:T,onError:A,updateNodePositions:C}=t();i={x:E,y:k};let O=!1,P={x:0,y:0,x2:0,y2:0};if(a.size>1&&R){const V=Ft(a,{nodeOrigin:S});P=vn(V)}for(const[V,B]of a){let F={x:E-B.distance.x,y:k-B.distance.y};g&&(F=Xt(F,H));let Y=[[R[0][0],R[0][1]],[R[1][0],R[1][1]]];if(a.size>1&&R&&!B.extent){const{positionAbsolute:K}=B.internals,J=K.x-P.x+R[0][0],X=K.x+B.measured.width-P.x2+R[1][0],Z=K.y-P.y+R[0][1],W=K.y+B.measured.height-P.y2+R[1][1];Y=[[J,Z],[X,W]]}const{position:G,positionAbsolute:q}=Ao({nodeId:V,nextPosition:F,nodeLookup:z,nodeExtent:Y,nodeOrigin:S,onError:A});O=O||B.position.x!==G.x||B.position.y!==G.y,B.position=G,B.internals.positionAbsolute=q}if(O&&(C(a,!0),L&&(r||_||!p&&T))){const[V,B]=an({nodeId:p,dragItems:a,nodeLookup:z});r==null||r(L,a,V,B),_==null||_(L,V,B),p||T==null||T(L,B)}}function M(){if(!u)return;const[E,k]=ko(c,u);if(E!==0||k!==0){const{transform:L,panBy:z}=t();i.x=(i.x??0)-E/L[2],i.y=(i.y??0)-k/L[2],z({x:E,y:k})&&m(i,null)}s=requestAnimationFrame(M)}function b(E){var O;const{nodeLookup:k,multiSelectionActive:L,nodesDraggable:z,transform:R,snapGrid:H,snapToGrid:g,selectNodesOnDrag:S,onNodeDragStart:_,onSelectionDragStart:T,unselectNodesAndEdges:A}=t();f=!0,(!S||!N)&&!L&&p&&((O=k.get(p))!=null&&O.selected||A()),N&&S&&p&&(e==null||e(p));const C=We(E.sourceEvent,{transform:R,snapGrid:H,snapToGrid:g});if(i=C,a=Fl(k,z,C,p),a.size>0&&(n||_||!p&&T)){const[P,V]=an({nodeId:p,dragItems:a,nodeLookup:k});n==null||n(E.sourceEvent,a,P,V),_==null||_(E.sourceEvent,P,V),p||T==null||T(E.sourceEvent,V)}}const I=lo().on("start",E=>{const{domNode:k,nodeDragThreshold:L,transform:z,snapGrid:R,snapToGrid:H}=t();L===0&&b(E),i=We(E.sourceEvent,{transform:z,snapGrid:R,snapToGrid:H}),u=(k==null?void 0:k.getBoundingClientRect())||null,c=ye(E.sourceEvent,u)}).on("drag",E=>{const{autoPanOnNodeDrag:k,transform:L,snapGrid:z,snapToGrid:R,nodeDragThreshold:H}=t(),g=We(E.sourceEvent,{transform:L,snapGrid:z,snapToGrid:R});if(!l&&k&&f&&(l=!0,M()),!f){const S=g.xSnapped-(i.x??0),_=g.ySnapped-(i.y??0);Math.sqrt(S*S+_*_)>H&&b(E)}(i.x!==g.xSnapped||i.y!==g.ySnapped)&&a&&f&&(c=ye(E.sourceEvent,u),m(g,E.sourceEvent))}).on("end",E=>{if(f&&(l=!1,f=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:k,updateNodePositions:L,onNodeDragStop:z,onSelectionDragStop:R}=t();if(L(a,!1),o||z||!p&&R){const[H,g]=an({nodeId:p,dragItems:a,nodeLookup:k});o==null||o(E.sourceEvent,a,H,g),z==null||z(E.sourceEvent,H,g),p||R==null||R(E.sourceEvent,g)}}}).filter(E=>{const k=E.target;return!E.button&&(!x||!_r(k,`.${x}`,w))&&(!v||_r(k,v,w))});d.call(I)}function y(){d==null||d.on(".drag",null)}return{update:h,destroy:y}}function br(e,t,n,r){return(t[n]||[]).reduce((o,i)=>(`${e.id}-${i.id}-${n}`!==r&&o.push({id:i.id||null,type:n,nodeId:e.id,x:e.internals.positionAbsolute.x+i.x+i.width/2,y:e.internals.positionAbsolute.y+i.y+i.height/2}),o),[])}function Yl(e,t,n){let r=[],o=1/0;for(const i of n){const s=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));s<=t&&(s<o?r=[i]:s===o&&r.push(i),o=s)}return r.length?r.length===1?r[0]:r.find(i=>i.type==="target")||r[0]:null}function Xl({nodeLookup:e,nodeId:t,handleId:n,handleType:r}){const o=[];for(const[,i]of e)if(i.internals.handleBounds){const s=`${t}-${n}-${r}`,a=br(i,i.internals.handleBounds,"source",s),l=br(i,i.internals.handleBounds,"target",s);o.push(...a,...l)}return o}function qo(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Wl(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}const Ko=()=>!0;let pt=null;function Gl(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:f,panBy:d,cancelConnection:h,onConnectStart:y,onConnect:x,onConnectEnd:v,isValidConnection:w=Ko,onEdgeUpdateEnd:N,updateConnection:p,getTransform:m,getConnectionStartHandle:M}){const b=zo(e.target);let I=0,E;const{x:k,y:L}=ye(e),z=b==null?void 0:b.elementFromPoint(k,L),R=qo(i,z),H=a==null?void 0:a.getBoundingClientRect();if(!H||!R)return;let g=ye(e,H),S=!1,_=null,T=!1,A=null;const C=Xl({nodeLookup:l,nodeId:o,handleId:r,handleType:R});function O(){if(!u||!H)return;const[B,F]=ko(g,H);d({x:B,y:F}),I=requestAnimationFrame(O)}pt={nodeId:o,handleId:r,type:R},p({connectionPosition:g,connectionStatus:null,connectionStartHandle:pt,connectionEndHandle:null}),y==null||y(e,{nodeId:o,handleId:r,handleType:R});function P(B){M()||V(B);const F=m();g=ye(B,H),E=Yl(Wt(g,F,!1,[1,1]),n,C),S||(O(),S=!0);const Y=Uo(B,{handle:E,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:s?"target":"source",isValidConnection:w,doc:b,lib:c,flowId:f});A=Y.handleDomNode,_=Y.connection,T=Y.isValid,p({connectionStartHandle:pt,connectionPosition:E&&T?Do({x:E.x,y:E.y},F):g,connectionStatus:Wl(!!E,T),connectionEndHandle:Y.endHandle})}function V(B){(E||A)&&_&&T&&(x==null||x(_)),v==null||v(B),i&&(N==null||N(B)),h(),cancelAnimationFrame(I),S=!1,T=!1,_=null,A=null,pt=null,b.removeEventListener("mousemove",P),b.removeEventListener("mouseup",V),b.removeEventListener("touchmove",P),b.removeEventListener("touchend",V)}b.addEventListener("mousemove",P),b.addEventListener("mouseup",V),b.addEventListener("touchmove",P),b.addEventListener("touchend",V)}function Uo(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:c=Ko}){const u=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:d,y:h}=ye(e),y=s.elementFromPoint(d,h),x=y!=null&&y.classList.contains(`${a}-flow__handle`)?y:f,v={handleDomNode:x,isValid:!1,connection:null,endHandle:null};if(x){const w=qo(void 0,x),N=x.getAttribute("data-nodeid"),p=x.getAttribute("data-handleid"),m=x.classList.contains("connectable"),M=x.classList.contains("connectableend");if(!N)return v;const b={source:u?N:r,sourceHandle:u?p:o,target:u?r:N,targetHandle:u?o:p};v.connection=b,m&&M&&(n===Ae.Strict?u&&w==="source"||!u&&w==="target":N!==r||p!==o)&&(v.endHandle={nodeId:N,handleId:p,type:w},v.isValid=c(b))}return v}const En={onPointerDown:Gl,isValid:Uo};function ql({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=se(e);function i({translateExtent:a,width:l,height:c,zoomStep:u=10,pannable:f=!0,zoomable:d=!0,inversePan:h=!1}){const y=p=>{const m=n();if(p.sourceEvent.type!=="wheel"||!t)return;const M=-p.sourceEvent.deltaY*(p.sourceEvent.deltaMode===1?.05:p.sourceEvent.deltaMode?1:.002)*u,b=m[2]*Math.pow(2,M);t.scaleTo(b)};let x=[0,0];const v=p=>{(p.sourceEvent.type==="mousedown"||p.sourceEvent.type==="touchstart")&&(x=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY])},w=p=>{const m=n();if(p.sourceEvent.type!=="mousemove"&&p.sourceEvent.type!=="touchmove"||!t)return;const M=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY],b=[M[0]-x[0],M[1]-x[1]];x=M;const I=r()*Math.max(m[2],Math.log(m[2]))*(h?-1:1),E={x:m[0]-b[0]*I,y:m[1]-b[1]*I},k=[[0,0],[l,c]];t.setViewportConstrained({x:E.x,y:E.y,zoom:m[2]},k,a)},N=Mo().on("start",v).on("zoom",f?w:null).on("zoom.wheel",d?y:null);o.call(N,{})}function s(){o.on("zoom",null)}return{update:i,destroy:s,pointer:ce}}const Kl=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Gt=e=>({x:e.x,y:e.y,zoom:e.k}),cn=({x:e,y:t,zoom:n})=>Bt.translate(e,t).scale(n),Te=(e,t)=>e.target.closest(`.${t}`),Zo=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),un=(e,t=0)=>typeof t=="number"&&t>0?e.transition().duration(t):e,Qo=e=>{const t=e.ctrlKey&&Rt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Ul({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(Te(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(u.ctrlKey&&s){const v=ce(u),w=Qo(u),N=f*Math.pow(2,w);r.scaleTo(n,N,v,u);return}const d=u.deltaMode===1?20:1;let h=o===$e.Vertical?0:u.deltaX*d,y=o===$e.Horizontal?0:u.deltaY*d;!Rt()&&u.shiftKey&&o!==$e.Vertical&&(h=u.deltaY*d,y=0),r.translateBy(n,-(h/f)*i,-(y/f)*i,{internal:!0});const x=Gt(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,x)),e.isPanScrolling&&(l==null||l(u,x),e.panScrollTimeout=setTimeout(()=>{c==null||c(u,x),e.isPanScrolling=!1},150))}}function Zl({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){if(!t&&r.type==="wheel"&&!r.ctrlKey||Te(r,e))return null;r.preventDefault(),n.call(this,r,o)}}function Ql({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var i,s,a;if((i=r.sourceEvent)!=null&&i.internal)return;const o=Gt(r.transform);e.mouseButton=((s=r.sourceEvent)==null?void 0:s.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function Jl({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{var s,a;e.usedRightMouseButton=!!(n&&Zo(t,e.mouseButton??0)),(s=i.sourceEvent)!=null&&s.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!((a=i.sourceEvent)!=null&&a.internal)&&(o==null||o(i.sourceEvent,Gt(i.transform)))}}function ed({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return s=>{var a;if(!((a=s.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,i&&Zo(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&Kl(e.prevViewport,s.transform))){const l=Gt(s.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(s.sourceEvent,l)},n?150:0)}}}function td({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:c}){return u=>{const f=e||t,d=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Te(u,`${c}-flow__node`)||Te(u,`${c}-flow__edge`)))return!0;if(!r&&!f&&!o&&!i&&!n||s||Te(u,a)&&u.type==="wheel"||Te(u,l)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel"||!f&&!o&&!d&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function nd({domNode:e,minZoom:t,maxZoom:n,translateExtent:r,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:a,onTransformChange:l,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=e.getBoundingClientRect(),d=Mo().scaleExtent([t,n]).translateExtent(r),h=se(e).call(d);p({x:o.x,y:o.y,zoom:He(o.zoom,t,n)},[[0,0],[f.width,f.height]],r);const y=h.on("wheel.zoom"),x=h.on("dblclick.zoom");d.wheelDelta(Qo);function v(z,R){h&&(d==null||d.transform(un(h,R==null?void 0:R.duration),z))}function w({noWheelClassName:z,noPanClassName:R,onPaneContextMenu:H,userSelectionActive:g,panOnScroll:S,panOnDrag:_,panOnScrollMode:T,panOnScrollSpeed:A,preventScrolling:C,zoomOnPinch:O,zoomOnScroll:P,zoomOnDoubleClick:V,zoomActivationKeyPressed:B,lib:F}){g&&!u.isZoomingOrPanning&&N();const G=S&&!B&&!g?Ul({zoomPanValues:u,noWheelClassName:z,d3Selection:h,d3Zoom:d,panOnScrollMode:T,panOnScrollSpeed:A,zoomOnPinch:O,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:a}):Zl({noWheelClassName:z,preventScrolling:C,d3ZoomHandler:y});if(h.on("wheel.zoom",G,{passive:!1}),!g){const K=Ql({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:s});d.on("start",K);const J=Jl({zoomPanValues:u,panOnDrag:_,onPaneContextMenu:!!H,onPanZoom:i,onTransformChange:l});d.on("zoom",J);const X=ed({zoomPanValues:u,panOnDrag:_,panOnScroll:S,onPaneContextMenu:H,onPanZoomEnd:a,onDraggingChange:c});d.on("end",X)}const q=td({zoomActivationKeyPressed:B,panOnDrag:_,zoomOnScroll:P,panOnScroll:S,zoomOnDoubleClick:V,zoomOnPinch:O,userSelectionActive:g,noPanClassName:R,noWheelClassName:z,lib:F});d.filter(q),V?h.on("dblclick.zoom",x):h.on("dblclick.zoom",null)}function N(){d.on("zoom",null)}function p(z,R,H){const g=cn(z),S=d==null?void 0:d.constrain()(g,R,H);return S&&v(S),S}function m(z,R){const H=cn(z);return v(H,R),H}function M(z){if(h){const R=cn(z),H=h.property("__zoom");(H.k!==z.zoom||H.x!==z.x||H.y!==z.y)&&(d==null||d.transform(h,R,null,{sync:!0}))}}function b(){const z=h?No(h.node()):{x:0,y:0,k:1};return{x:z.x,y:z.y,zoom:z.k}}function I(z,R){h&&(d==null||d.scaleTo(un(h,R==null?void 0:R.duration),z))}function E(z,R){h&&(d==null||d.scaleBy(un(h,R==null?void 0:R.duration),z))}function k(z){d==null||d.scaleExtent(z)}function L(z){d==null||d.translateExtent(z)}return{update:w,destroy:N,setViewport:m,setViewportConstrained:p,getViewport:b,scaleTo:I,scaleBy:E,setScaleExtent:k,setTranslateExtent:L,syncViewport:M}}var Ge;(function(e){e.Line="line",e.Handle="handle"})(Ge||(Ge={}));function rd({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:i}){const s=e-t,a=n-r,l=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&o&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function od(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function ve(e,t){return Math.max(0,t-e)}function _e(e,t){return Math.max(0,e-t)}function mt(e,t,n){return Math.max(0,t-e,e-n)}function Sr(e,t){return e?!t:t}function id(e,t,n,r,o,i,s,a){let{affectsX:l,affectsY:c}=t;const{isHorizontal:u,isVertical:f}=t,d=u&&f,{xSnapped:h,ySnapped:y}=n,{minWidth:x,maxWidth:v,minHeight:w,maxHeight:N}=r,{x:p,y:m,width:M,height:b,aspectRatio:I}=e;let E=Math.floor(u?h-e.pointerX:0),k=Math.floor(f?y-e.pointerY:0);const L=M+(l?-E:E),z=b+(c?-k:k),R=-i[0]*M,H=-i[1]*b;let g=mt(L,x,v),S=mt(z,w,N);if(s){let A=0,C=0;l&&E<0?A=ve(p+E+R,s[0][0]):!l&&E>0&&(A=_e(p+L+R,s[1][0])),c&&k<0?C=ve(m+k+H,s[0][1]):!c&&k>0&&(C=_e(m+z+H,s[1][1])),g=Math.max(g,A),S=Math.max(S,C)}if(a){let A=0,C=0;l&&E>0?A=_e(p+E,a[0][0]):!l&&E<0&&(A=ve(p+L,a[1][0])),c&&k>0?C=_e(m+k,a[0][1]):!c&&k<0&&(C=ve(m+z,a[1][1])),g=Math.max(g,A),S=Math.max(S,C)}if(o){if(u){const A=mt(L/I,w,N)*I;if(g=Math.max(g,A),s){let C=0;!l&&!c||l&&!c&&d?C=_e(m+H+L/I,s[1][1])*I:C=ve(m+H+(l?E:-E)/I,s[0][1])*I,g=Math.max(g,C)}if(a){let C=0;!l&&!c||l&&!c&&d?C=ve(m+L/I,a[1][1])*I:C=_e(m+(l?E:-E)/I,a[0][1])*I,g=Math.max(g,C)}}if(f){const A=mt(z*I,x,v)/I;if(S=Math.max(S,A),s){let C=0;!l&&!c||c&&!l&&d?C=_e(p+z*I+R,s[1][0])/I:C=ve(p+(c?k:-k)*I+R,s[0][0])/I,S=Math.max(S,C)}if(a){let C=0;!l&&!c||c&&!l&&d?C=ve(p+z*I,a[1][0])/I:C=_e(p+(c?k:-k)*I,a[0][0])/I,S=Math.max(S,C)}}}k=k+(k<0?S:-S),E=E+(E<0?g:-g),o&&(d?L>z*I?k=(Sr(l,c)?-E:E)/I:E=(Sr(l,c)?-k:k)*I:u?(k=E/I,c=l):(E=k*I,l=c));const _=l?p+E:p,T=c?m+k:m;return{width:M+(l?-E:E),height:b+(c?-k:k),x:i[0]*E*(l?-1:1)+_,y:i[1]*k*(c?-1:1)+T}}const Jo={width:0,height:0,x:0,y:0},sd={...Jo,pointerX:0,pointerY:0,aspectRatio:1};function ad(e){return[[0,0],[e.measured.width,e.measured.height]]}function cd(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,l=n[1]*s;return[[r-a,o-l],[r+i-a,o+s-l]]}function ud({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const i=se(e);function s({controlPosition:l,boundaries:c,keepAspectRatio:u,onResizeStart:f,onResize:d,onResizeEnd:h,shouldResize:y}){let x={...Jo},v={...sd};const w=od(l);let N,p=[],m,M,b;const I=lo().on("start",E=>{var _,T;const{nodeLookup:k,transform:L,snapGrid:z,snapToGrid:R,nodeOrigin:H}=n();if(N=k.get(t),!N)return;const{xSnapped:g,ySnapped:S}=We(E.sourceEvent,{transform:L,snapGrid:z,snapToGrid:R});x={width:((_=N.measured)==null?void 0:_.width)??0,height:((T=N.measured)==null?void 0:T.height)??0,x:N.position.x??0,y:N.position.y??0},v={...x,pointerX:g,pointerY:S,aspectRatio:x.width/x.height},m=void 0,(N.extent==="parent"||N.expandParent)&&(m=k.get(N.parentId),m&&N.extent==="parent"&&(M=ad(m))),p=[],b=void 0;for(const[A,C]of k)if(C.parentId===t&&(p.push({id:A,position:{...C.position},extent:C.extent}),C.extent==="parent"||C.expandParent)){const O=cd(C,N,C.origin??H);b?b=[[Math.min(O[0][0],b[0][0]),Math.min(O[0][1],b[0][1])],[Math.max(O[1][0],b[1][0]),Math.max(O[1][1],b[1][1])]]:b=O}f==null||f(E,{...x})}).on("drag",E=>{const{transform:k,snapGrid:L,snapToGrid:z,nodeOrigin:R}=n(),H=We(E.sourceEvent,{transform:k,snapGrid:L,snapToGrid:z}),g=[];if(!N)return;const{x:S,y:_,width:T,height:A}=x,C={},O=N.origin??R,{width:P,height:V,x:B,y:F}=id(v,w,H,c,u,O,M,b),Y=P!==T,G=V!==A,q=B!==S&&Y,K=F!==_&&G;if(!q&&!K&&!Y&&!G)return;if((q||K||O[0]===1||O[1]==1)&&(C.x=q?B:x.x,C.y=K?F:x.y,x.x=C.x,x.y=C.y,m&&N.expandParent&&(C.x&&C.x<0&&(x.x=0,v.x=v.x-C.x),C.y&&C.y<0&&(x.y=0,v.y=v.y-C.y)),p.length>0)){const W=B-S,re=F-_;for(const ne of p)ne.position={x:ne.position.x-W+O[0]*(P-T),y:ne.position.y-re+O[1]*(V-A)},g.push(ne)}(Y||G)&&(C.width=Y?P:x.width,C.height=G?V:x.height,x.width=C.width,x.height=C.height);const J=rd({width:x.width,prevWidth:T,height:x.height,prevHeight:A,affectsX:w.affectsX,affectsY:w.affectsY}),X={...x,direction:J};(y==null?void 0:y(E,X))!==!1&&(d==null||d(E,X),r(C,g))}).on("end",E=>{h==null||h(E,{...x}),o==null||o()});i.call(I)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}var ei={exports:{}},ti={},ni={exports:{}},ri={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=D,t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function n(p){{for(var m=arguments.length,M=new Array(m>1?m-1:0),b=1;b<m;b++)M[b-1]=arguments[b];r("error",p,M)}}function r(p,m,M){{var b=t.ReactDebugCurrentFrame,I=b.getStackAddendum();I!==""&&(m+="%s",M=M.concat([I]));var E=M.map(function(k){return String(k)});E.unshift("Warning: "+m),Function.prototype.apply.call(console[p],console,E)}}function o(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var i=typeof Object.is=="function"?Object.is:o,s=e.useState,a=e.useEffect,l=e.useLayoutEffect,c=e.useDebugValue,u=!1,f=!1;function d(p,m,M){u||e.startTransition!==void 0&&(u=!0,n("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var b=m();if(!f){var I=m();i(b,I)||(n("The result of getSnapshot should be cached to avoid an infinite loop"),f=!0)}var E=s({inst:{value:b,getSnapshot:m}}),k=E[0].inst,L=E[1];return l(function(){k.value=b,k.getSnapshot=m,h(k)&&L({inst:k})},[p,b,m]),a(function(){h(k)&&L({inst:k});var z=function(){h(k)&&L({inst:k})};return p(z)},[p]),c(b),b}function h(p){var m=p.getSnapshot,M=p.value;try{var b=m();return!i(M,b)}catch{return!0}}function y(p,m,M){return m()}var x=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",v=!x,w=v?y:d,N=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:w;ri.useSyncExternalStore=N,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})();ni.exports=ri;var ld=ni.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=D,t=ld;function n(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var r=typeof Object.is=="function"?Object.is:n,o=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,a=e.useMemo,l=e.useDebugValue;function c(u,f,d,h,y){var x=i(null),v;x.current===null?(v={hasValue:!1,value:null},x.current=v):v=x.current;var w=a(function(){var M=!1,b,I,E=function(R){if(!M){M=!0,b=R;var H=h(R);if(y!==void 0&&v.hasValue){var g=v.value;if(y(g,H))return I=g,g}return I=H,H}var S=b,_=I;if(r(S,R))return _;var T=h(R);return y!==void 0&&y(_,T)?_:(b=R,I=T,T)},k=d===void 0?null:d,L=function(){return E(f())},z=k===null?void 0:function(){return E(k())};return[L,z]},[f,d,h,y]),N=w[0],p=w[1],m=o(u,N,p);return s(function(){v.hasValue=!0,v.value=m},[m]),l(m),m}ti.useSyncExternalStoreWithSelector=c,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)})();ei.exports=ti;var dd=ei.exports;const oi=Vs(dd);var fd={VITE_USER_NODE_ENV:"development",BASE_URL:"/",MODE:"development",DEV:!0,PROD:!1,SSR:!1};const Er=e=>{let t;const n=new Set,r=(u,f)=>{const d=typeof u=="function"?u(t):u;if(!Object.is(d,t)){const h=t;t=f??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(y=>y(t,h))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(fd?"development":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,o,l);return l},ii=e=>e?Er(e):Er,{useDebugValue:hd}=Kr,{useSyncExternalStoreWithSelector:gd}=oi,pd=e=>e;function si(e,t=pd,n){const r=gd(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return hd(r),r}const Nr=(e,t)=>{const n=ii(e),r=(o,i=t)=>si(n,o,i);return Object.assign(r,n),r},md=(e,t)=>e?Nr(e,t):Nr;function ee(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const qt=D.createContext(null),yd=qt.Provider,ai=ie.error001();function U(e,t){const n=D.useContext(qt);if(n===null)throw new Error(ai);return si(n,e,t)}function Q(){const e=D.useContext(qt);if(e===null)throw new Error(ai);return D.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Mr={display:"none"},xd={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ci="react-flow__node-desc",ui="react-flow__edge-desc",wd="react-flow__aria-live",vd=e=>e.ariaLiveMessage;function _d({rfId:e}){const t=U(vd);return $.jsx("div",{id:`${wd}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:xd,children:t})}function bd({rfId:e,disableKeyboardA11y:t}){return $.jsxs($.Fragment,{children:[$.jsxs("div",{id:`${ci}-${e}`,style:Mr,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),$.jsx("div",{id:`${ui}-${e}`,style:Mr,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&$.jsx(_d,{rfId:e})]})}const Sd=e=>e.userSelectionActive?"none":"all";function zn({position:e="top-left",children:t,className:n,style:r,...o}){const i=U(Sd),s=`${e}`.split("-");return $.jsx("div",{className:te(["react-flow__panel",n,...s]),style:{...r,pointerEvents:i},...o,children:t})}function Ed({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:$.jsx(zn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:$.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Nd=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},yt=e=>e.id;function Md(e,t){return ee(e.selectedNodes.map(yt),t.selectedNodes.map(yt))&&ee(e.selectedEdges.map(yt),t.selectedEdges.map(yt))}function Cd({onSelectionChange:e}){const t=Q(),{selectedNodes:n,selectedEdges:r}=U(Nd,Md);return D.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(i=>i(o))},[n,r,e]),null}const $d=e=>!!e.onSelectionChangeHandlers;function Id({onSelectionChange:e}){const t=U($d);return e||t?$.jsx(Cd,{onSelectionChange:e}):null}const li=[0,0],Ad={x:0,y:0,zoom:1},kd=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesUpdatable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug"],Cr=[...kd,"rfId"],Td=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),$r={translateExtent:It,nodeOrigin:li,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function Dd(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:l}=U(Td,ee),c=Q();D.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{u.current=$r,a()}),[]);const u=D.useRef($r);return D.useEffect(()=>{for(const f of Cr){const d=e[f],h=u.current[f];d!==h&&(typeof e[f]>"u"||(f==="nodes"?t(d):f==="edges"?n(d):f==="minZoom"?r(d):f==="maxZoom"?o(d):f==="translateExtent"?i(d):f==="nodeExtent"?s(d):f==="fitView"?c.setState({fitViewOnInit:d}):f==="fitViewOptions"?c.setState({fitViewOnInitOptions:d}):c.setState({[f]:d})))}u.current=e},Cr.map(f=>e[f])),null}function Ir(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Rd(e){var r;const[t,n]=D.useState(e==="system"?null:e);return D.useEffect(()=>{if(e!=="system"){n(e);return}const o=Ir(),i=()=>n(o!=null&&o.matches?"dark":"light");return i(),o==null||o.addEventListener("change",i),()=>{o==null||o.removeEventListener("change",i)}},[e]),t!==null?t:(r=Ir())!=null&&r.matches?"dark":"light"}const Ar=typeof document<"u"?document:null;function tt(e=null,t={target:Ar,actInsideInputWithModifier:!0}){const[n,r]=D.useState(!1),o=D.useRef(!1),i=D.useRef(new Set([])),[s,a]=D.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=c.reduce((f,d)=>f.concat(...d),[]);return[c,u]}return[[],[]]},[e]);return D.useEffect(()=>{const l=(t==null?void 0:t.target)||Ar;if(e!==null){const c=d=>{if(o.current=d.ctrlKey||d.metaKey||d.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&_n(d))return!1;const y=Tr(d.code,a);i.current.add(d[y]),kr(s,i.current,!1)&&(d.preventDefault(),r(!0))},u=d=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&_n(d))return!1;const y=Tr(d.code,a);kr(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(d[y]),d.key==="Meta"&&i.current.clear(),o.current=!1},f=()=>{i.current.clear(),r(!1)};return l==null||l.addEventListener("keydown",c),l==null||l.addEventListener("keyup",u),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{l==null||l.removeEventListener("keydown",c),l==null||l.removeEventListener("keyup",u),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function kr(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Tr(e,t){return t.includes(e)?"code":"key"}const Ld=()=>{const e=Q();return D.useMemo(()=>({zoomIn:t=>{var n;return(n=e.getState().panZoom)==null?void 0:n.scaleBy(1.2,{duration:t==null?void 0:t.duration})},zoomOut:t=>{var n;return(n=e.getState().panZoom)==null?void 0:n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration})},zoomTo:(t,n)=>{var r;return(r=e.getState().panZoom)==null?void 0:r.scaleTo(t,{duration:n==null?void 0:n.duration})},getZoom:()=>e.getState().transform[2],setViewport:(t,n)=>{const{transform:[r,o,i],panZoom:s}=e.getState();s==null||s.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??i},{duration:n==null?void 0:n.duration})},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,width:r,height:o,nodeOrigin:i,minZoom:s,maxZoom:a,panZoom:l}=e.getState();return l?Io({nodeLookup:n,width:r,height:o,nodeOrigin:i,minZoom:s,maxZoom:a,panZoom:l},t):!1},setCenter:(t,n,r)=>{const{width:o,height:i,maxZoom:s,panZoom:a}=e.getState(),l=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:s,c=o/2-t*l,u=i/2-n*l;a==null||a.setViewport({x:c,y:u,zoom:l},{duration:r==null?void 0:r.duration})},fitBounds:(t,n)=>{const{width:r,height:o,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),l=Dn(t,r,o,i,s,(n==null?void 0:n.padding)??.1);a==null||a.setViewport(l,{duration:n==null?void 0:n.duration})},screenToFlowPosition:(t,n={snapToGrid:!0})=>{const{transform:r,snapGrid:o,domNode:i}=e.getState();if(!i)return t;const{x:s,y:a}=i.getBoundingClientRect(),l={x:t.x-s,y:t.y-a};return Wt(l,r,n.snapToGrid,o)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:i}=r.getBoundingClientRect(),s=Do(t,n);return{x:s.x+o,y:s.y+i}}}),[])};function di(e,t){const n=[],r=new Map;for(const o of e)if(o.type==="add"){n.push(o.item);continue}else if(o.type==="remove"||o.type==="replace")r.set(o.id,[o]);else{const i=r.get(o.id);i?i.push(o):r.set(o.id,[o])}for(const o of t){const i=r.get(o.id);if(!i){n.push(o);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const s={...o};for(const a of i)zd(a,s);n.push(s)}return n}function zd(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function fi(e,t){return di(e,t)}function hi(e,t){return di(e,t)}function Ne(e,t){return{id:e,type:"select",selected:t}}function De(e,t=new Set,n=!1){const r=[];for(const[o,i]of e){const s=t.has(o);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),r.push(Ne(i.id,s)))}return r}function Dr({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(i=>[i.id,i]));for(const i of e){const s=t.get(i.id),a=((o=s==null?void 0:s.internals)==null?void 0:o.userNode)??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add"})}for(const[i]of t)r.get(i)===void 0&&n.push({id:i,type:"remove"});return n}function Rr(e){return{id:e.id,type:"remove"}}const Lr=e=>_l(e);function gi(e){return D.forwardRef(e)}const Od=typeof window<"u"?D.useLayoutEffect:D.useEffect;function zr(e){const[t,n]=D.useState(!1),[r]=D.useState(()=>Hd(()=>n(!0)));return Od(()=>{if(!t){r.reset();return}const o=r.get();o.length&&(e(o),r.reset()),n(!1)},[t]),r}function Hd(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const pi=D.createContext(null);function Pd({children:e}){const t=Q(),n=D.useCallback(a=>{const{nodes:l=[],setNodes:c,hasDefaultNodes:u,onNodesChange:f,nodeLookup:d}=t.getState();let h=l;for(const y of a)h=typeof y=="function"?y(h):y;u?c(h):f&&f(Dr({items:h,lookup:d}))},[]),r=zr(n),o=D.useCallback(a=>{const{edges:l=[],setEdges:c,hasDefaultEdges:u,onEdgesChange:f,edgeLookup:d}=t.getState();let h=l;for(const y of a)h=typeof y=="function"?y(h):y;u?c(h):f&&f(Dr({items:h,lookup:d}))},[]),i=zr(o),s=D.useMemo(()=>({nodeQueue:r,edgeQueue:i}),[]);return $.jsx(pi.Provider,{value:s,children:e})}function Vd(){const e=D.useContext(pi);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Bd=e=>!!e.panZoom;function On(){const e=Ld(),t=Q(),n=Vd(),r=U(Bd),o=D.useMemo(()=>{const i=c=>t.getState().nodeLookup.get(c),s=c=>{n.nodeQueue.push(c)},a=c=>{var x,v;const{nodeLookup:u,nodeOrigin:f}=t.getState(),d=Lr(c)?c:u.get(c.id),h=d.parentId?Lo(d.position,d.parentId,u,f):d.position,y={id:d.id,position:h,width:((x=d.measured)==null?void 0:x.width)??d.width,height:((v=d.measured)==null?void 0:v.height)??d.height,data:d.data};return et(y)},l=(c,u,f={replace:!1})=>{s(d=>d.map(h=>{if(h.id===c){const y=typeof u=="function"?u(h):u;return f.replace&&Lr(y)?y:{...h,...y}}return h}))};return{getNodes:()=>t.getState().nodes.map(c=>({...c})),getNode:c=>{var u;return(u=i(c))==null?void 0:u.internals.userNode},getInternalNode:i,getEdges:()=>{const{edges:c=[]}=t.getState();return c.map(u=>({...u}))},getEdge:c=>t.getState().edgeLookup.get(c),setNodes:s,setEdges:c=>{n.edgeQueue.push(c)},addNodes:c=>{const u=Array.isArray(c)?c:[c];n.nodeQueue.push(f=>[...f,...u])},addEdges:c=>{const u=Array.isArray(c)?c:[c];n.edgeQueue.push(f=>[...f,...u])},toObject:()=>{const{nodes:c=[],edges:u=[],transform:f}=t.getState(),[d,h,y]=f;return{nodes:c.map(x=>({...x})),edges:u.map(x=>({...x})),viewport:{x:d,y:h,zoom:y}}},deleteElements:async({nodes:c=[],edges:u=[]})=>{const{nodes:f,edges:d,onNodesDelete:h,onEdgesDelete:y,triggerNodeChanges:x,triggerEdgeChanges:v,onDelete:w,onBeforeDelete:N}=t.getState(),{nodes:p,edges:m}=await Ml({nodesToRemove:c,edgesToRemove:u,nodes:f,edges:d,onBeforeDelete:N}),M=m.length>0,b=p.length>0;if(M){const I=m.map(Rr);y==null||y(m),v(I)}if(b){const I=p.map(Rr);h==null||h(p),x(I)}return(b||M)&&(w==null||w({nodes:p,edges:m})),{deletedNodes:p,deletedEdges:m}},getIntersectingNodes:(c,u=!0,f)=>{const d=dr(c),h=d?c:a(c),y=f!==void 0;return h?(f||t.getState().nodes).filter(x=>{const v=t.getState().nodeLookup.get(x.id);if(v&&!d&&(x.id===c.id||!v.internals.positionAbsolute))return!1;const w=et(y?x:v),N=Tt(w,h);return u&&N>0||N>=h.width*h.height}):[]},isNodeIntersecting:(c,u,f=!0)=>{const h=dr(c)?c:a(c);if(!h)return!1;const y=Tt(h,u);return f&&y>0||y>=h.width*h.height},updateNode:l,updateNodeData:(c,u,f={replace:!1})=>{l(c,d=>{const h=typeof u=="function"?u(d):u;return f.replace?{...d,data:h}:{...d,data:{...d.data,...h}}},f)}}},[]);return D.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const Or=e=>e.selected,Fd={actInsideInputWithModifier:!1};function jd({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Q(),{deleteElements:r}=On(),o=tt(e,Fd),i=tt(t);D.useEffect(()=>{if(o){const{edges:s,nodes:a}=n.getState();r({nodes:a.filter(Or),edges:s.filter(Or)}),n.setState({nodesSelectionActive:!1})}},[o]),D.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function Yd(e){const t=Q();D.useEffect(()=>{const n=()=>{var o,i;if(!e.current)return!1;const r=Rn(e.current);(r.height===0||r.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",ie.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Kt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Xd=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Wd({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:i=$e.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:u,maxZoom:f,zoomActivationKeyCode:d,preventScrolling:h=!0,children:y,noWheelClassName:x,noPanClassName:v,onViewportChange:w,isControlledViewport:N}){const p=Q(),m=D.useRef(null),{userSelectionActive:M,lib:b}=U(Xd,ee),I=tt(d),E=D.useRef();return Yd(m),D.useEffect(()=>{if(m.current){E.current=nd({domNode:m.current,minZoom:u,maxZoom:f,translateExtent:c,viewport:l,onTransformChange:R=>{w==null||w({x:R[0],y:R[1],zoom:R[2]}),N||p.setState({transform:R})},onDraggingChange:R=>p.setState({paneDragging:R}),onPanZoomStart:(R,H)=>{const{onViewportChangeStart:g,onMoveStart:S}=p.getState();S==null||S(R,H),g==null||g(H)},onPanZoom:(R,H)=>{const{onViewportChange:g,onMove:S}=p.getState();S==null||S(R,H),g==null||g(H)},onPanZoomEnd:(R,H)=>{const{onViewportChangeEnd:g,onMoveEnd:S}=p.getState();S==null||S(R,H),g==null||g(H)}});const{x:k,y:L,zoom:z}=E.current.getViewport();return p.setState({panZoom:E.current,transform:[k,L,z],domNode:m.current.closest(".react-flow")}),()=>{var R;(R=E.current)==null||R.destroy()}}},[]),D.useEffect(()=>{var k;(k=E.current)==null||k.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:I,preventScrolling:h,noPanClassName:v,userSelectionActive:M,noWheelClassName:x,lib:b})},[e,t,n,r,o,i,s,a,I,h,v,M,x,b]),$.jsx("div",{className:"react-flow__renderer",ref:m,style:Kt,children:y})}const Gd=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function qd(){const{userSelectionActive:e,userSelectionRect:t}=U(Gd,ee);return e&&t?$.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const ln=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Kd=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function Ud({isSelecting:e,selectionMode:t=Je.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:c,onPaneMouseLeave:u,children:f}){const d=D.useRef(null),h=Q(),y=D.useRef(0),x=D.useRef(0),v=D.useRef(),w=D.useRef(new Map),{userSelectionActive:N,elementsSelectable:p,dragging:m}=U(Kd,ee),M=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,x.current=0},b=g=>{i==null||i(g),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},I=g=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){g.preventDefault();return}s==null||s(g)},E=a?g=>a(g):void 0,k=g=>{var O,P;const{resetSelectedElements:S,domNode:_,edgeLookup:T}=h.getState();if(v.current=_==null?void 0:_.getBoundingClientRect(),!p||!e||g.button!==0||g.target!==d.current||!v.current)return;w.current=new Map;for(const[V,B]of T)w.current.set(B.source,((O=w.current.get(B.source))==null?void 0:O.add(V))||new Set([V])),w.current.set(B.target,((P=w.current.get(B.target))==null?void 0:P.add(V))||new Set([V]));const{x:A,y:C}=ye(g.nativeEvent,v.current);S(),h.setState({userSelectionRect:{width:0,height:0,startX:A,startY:C,x:A,y:C}}),r==null||r(g)},L=g=>{const{userSelectionRect:S,edgeLookup:_,transform:T,nodeOrigin:A,nodeLookup:C,triggerNodeChanges:O,triggerEdgeChanges:P}=h.getState();if(!e||!v.current||!S)return;const{x:V,y:B}=ye(g.nativeEvent,v.current),{startX:F,startY:Y}=S,G={startX:F,startY:Y,x:V<F?V:F,y:B<Y?B:Y,width:Math.abs(V-F),height:Math.abs(B-Y)},q=$o(C,G,T,t===Je.Partial,!0,A),K=new Set,J=new Set;for(const X of q){J.add(X.id);const Z=w.current.get(X.id);if(Z)for(const W of Z)K.add(W)}if(y.current!==J.size){y.current=J.size;const X=De(C,J,!0);O(X)}if(x.current!==K.size){x.current=K.size;const X=De(_,K);P(X)}h.setState({userSelectionRect:G,userSelectionActive:!0,nodesSelectionActive:!1})},z=g=>{if(g.button!==0)return;const{userSelectionRect:S}=h.getState();!N&&S&&g.target===d.current&&(b==null||b(g)),h.setState({nodesSelectionActive:y.current>0}),M(),o==null||o(g)},R=g=>{N&&(h.setState({nodesSelectionActive:y.current>0}),o==null||o(g)),M()},H=p&&(e||N);return $.jsxs("div",{className:te(["react-flow__pane",{draggable:n,dragging:m,selection:e}]),onClick:H?void 0:ln(b,d),onContextMenu:ln(I,d),onWheel:ln(E,d),onMouseEnter:H?void 0:l,onMouseDown:H?k:void 0,onMouseMove:H?L:c,onMouseUp:H?z:void 0,onMouseLeave:H?R:u,ref:d,style:Kt,children:[f,$.jsx(qd,{})]})}function Nn({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:l}=t.getState(),c=a.get(e);if(!c){l==null||l("012",ie.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):o([e])}function mi({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i}){const s=Q(),[a,l]=D.useState(!1),c=D.useRef();return D.useEffect(()=>{c.current=jl({getStoreItems:()=>s.getState(),onNodeMouseDown:u=>{Nn({id:u,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),D.useEffect(()=>{var u,f;if(t)(u=c.current)==null||u.destroy();else if(e.current)return(f=c.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:i,nodeId:o}),()=>{var d;(d=c.current)==null||d.destroy()}},[n,r,t,i,e,o]),a}const Zd=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function yi(){const e=Q();return D.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:u}=e.getState(),f=new Map,d=Zd(s),h=o?i[0]:5,y=o?i[1]:5,x=n.direction.x*h*n.factor,v=n.direction.y*y*n.factor;for(const[,w]of c){if(!d(w))continue;let N={x:w.internals.positionAbsolute.x+x,y:w.internals.positionAbsolute.y+v};o&&(N=Xt(N,i));const{position:p,positionAbsolute:m}=Ao({nodeId:w.id,nextPosition:N,nodeLookup:c,nodeExtent:r,nodeOrigin:u,onError:a});w.position=p,w.internals.positionAbsolute=m,f.set(w.id,w)}l(f)},[])}const Hn=D.createContext(null),Qd=Hn.Provider;Hn.Consumer;const xi=()=>D.useContext(Hn),Jd=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ef=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:s,connectionMode:a,connectionStatus:l}=r,c=(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n;return{connectingFrom:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n,connectingTo:c,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n,isPossibleEndHandle:a===Ae.Strict?(o==null?void 0:o.type)!==n:e!==(o==null?void 0:o.nodeId)||t!==(o==null?void 0:o.handleId),connectionInProcess:!!o,valid:c&&l==="valid"}};function tf({type:e="source",position:t=j.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:c,onMouseDown:u,onTouchStart:f,...d},h){var g,S;const y=s||null,x=e==="target",v=Q(),w=xi(),{connectOnClick:N,noPanClassName:p,rfId:m}=U(Jd,ee),{connectingFrom:M,connectingTo:b,clickConnecting:I,isPossibleEndHandle:E,connectionInProcess:k,valid:L}=U(ef(w,y,e),ee);w||(S=(g=v.getState()).onError)==null||S.call(g,"010",ie.error010());const z=_=>{const{defaultEdgeOptions:T,onConnect:A,hasDefaultEdges:C}=v.getState(),O={...T,..._};if(C){const{edges:P,setEdges:V}=v.getState();V(Fo(O,P))}A==null||A(O),a==null||a(O)},R=_=>{if(!w)return;const T=Oo(_.nativeEvent);if(o&&(T&&_.button===0||!T)){const A=v.getState();En.onPointerDown(_.nativeEvent,{autoPanOnConnect:A.autoPanOnConnect,connectionMode:A.connectionMode,connectionRadius:A.connectionRadius,domNode:A.domNode,nodeLookup:A.nodeLookup,lib:A.lib,isTarget:x,handleId:y,nodeId:w,flowId:A.rfId,panBy:A.panBy,cancelConnection:A.cancelConnection,onConnectStart:A.onConnectStart,onConnectEnd:A.onConnectEnd,updateConnection:A.updateConnection,onConnect:z,isValidConnection:n||A.isValidConnection,getTransform:()=>v.getState().transform,getConnectionStartHandle:()=>v.getState().connectionStartHandle})}T?u==null||u(_):f==null||f(_)},H=_=>{const{onClickConnectStart:T,onClickConnectEnd:A,connectionClickStartHandle:C,connectionMode:O,isValidConnection:P,lib:V,rfId:B}=v.getState();if(!w||!C&&!o)return;if(!C){T==null||T(_.nativeEvent,{nodeId:w,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:w,type:e,handleId:y}});return}const F=zo(_.target),Y=n||P,{connection:G,isValid:q}=En.isValid(_.nativeEvent,{handle:{nodeId:w,id:y,type:e},connectionMode:O,fromNodeId:C.nodeId,fromHandleId:C.handleId||null,fromType:C.type,isValidConnection:Y,flowId:B,doc:F,lib:V});q&&G&&z(G),A==null||A(_),v.setState({connectionClickStartHandle:null})};return $.jsx("div",{"data-handleid":y,"data-nodeid":w,"data-handlepos":t,"data-id":`${m}-${w}-${y}-${e}`,className:te(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",p,c,{source:!x,target:x,connectable:r,connectablestart:o,connectableend:i,clickconnecting:I,connectingfrom:M,connectingto:b,valid:L,connectionindicator:r&&(!k||E)&&(k?i:o)}]),onMouseDown:R,onTouchStart:R,onClick:N?H:void 0,ref:h,...d,children:l})}const Lt=D.memo(gi(tf));function nf({data:e,isConnectable:t,sourcePosition:n=j.Bottom}){return $.jsxs($.Fragment,{children:[e==null?void 0:e.label,$.jsx(Lt,{type:"source",position:n,isConnectable:t})]})}function rf({data:e,isConnectable:t,targetPosition:n=j.Top,sourcePosition:r=j.Bottom}){return $.jsxs($.Fragment,{children:[$.jsx(Lt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,$.jsx(Lt,{type:"source",position:r,isConnectable:t})]})}function of(){return null}function sf({data:e,isConnectable:t,targetPosition:n=j.Top}){return $.jsxs($.Fragment,{children:[$.jsx(Lt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const zt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Hr={input:nf,default:rf,output:sf,group:of};function af(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const cf=e=>{const{width:t,height:n,x:r,y:o}=Ft(e.nodeLookup,{nodeOrigin:e.nodeOrigin,filter:i=>!!i.selected});return{width:de(t)?t:null,height:de(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function uf({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Q(),{width:o,height:i,transformString:s,userSelectionActive:a}=U(cf,ee),l=yi(),c=D.useRef(null);if(D.useEffect(()=>{var d;n||(d=c.current)==null||d.focus({preventScroll:!0})},[n]),mi({nodeRef:c}),a||!o||!i)return null;const u=e?d=>{const h=r.getState().nodes.filter(y=>y.selected);e(d,h)}:void 0,f=d=>{Object.prototype.hasOwnProperty.call(zt,d.key)&&l({direction:zt[d.key],factor:d.shiftKey?4:1})};return $.jsx("div",{className:te(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:$.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:o,height:i}})})}const lf=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function wi({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,selectionKeyCode:l,selectionOnDrag:c,selectionMode:u,onSelectionStart:f,onSelectionEnd:d,multiSelectionKeyCode:h,panActivationKeyCode:y,zoomActivationKeyCode:x,elementsSelectable:v,zoomOnScroll:w,zoomOnPinch:N,panOnScroll:p,panOnScrollSpeed:m,panOnScrollMode:M,zoomOnDoubleClick:b,panOnDrag:I,defaultViewport:E,translateExtent:k,minZoom:L,maxZoom:z,preventScrolling:R,onSelectionContextMenu:H,noWheelClassName:g,noPanClassName:S,disableKeyboardA11y:_,onViewportChange:T,isControlledViewport:A}){const{nodesSelectionActive:C,userSelectionActive:O}=U(lf),P=tt(l),V=tt(y),B=V||I,F=V||p,Y=P||O||c&&B!==!0;return jd({deleteKeyCode:a,multiSelectionKeyCode:h}),$.jsx(Wd,{onPaneContextMenu:i,elementsSelectable:v,zoomOnScroll:w,zoomOnPinch:N,panOnScroll:F,panOnScrollSpeed:m,panOnScrollMode:M,zoomOnDoubleClick:b,panOnDrag:!P&&B,defaultViewport:E,translateExtent:k,minZoom:L,maxZoom:z,zoomActivationKeyCode:x,preventScrolling:R,noWheelClassName:g,noPanClassName:S,onViewportChange:T,isControlledViewport:A,children:$.jsxs(Ud,{onSelectionStart:f,onSelectionEnd:d,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:B,isSelecting:!!Y,selectionMode:u,children:[e,C&&$.jsx(uf,{onSelectionContextMenu:H,noPanClassName:S,disableKeyboardA11y:_})]})})}wi.displayName="FlowRenderer";const df=D.memo(wi),ff=e=>t=>e?$o(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function hf(e){return U(D.useCallback(ff(e),[e]),ee)}const gf=e=>e.updateNodeInternals;function pf(){const e=U(gf),[t]=D.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const i=o.target.getAttribute("data-id");r.set(i,{id:i,nodeElement:o.target})}),e(r)}));return D.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function mf({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=Q(),i=D.useRef(null),s=D.useRef(null),a=D.useRef(e.sourcePosition),l=D.useRef(e.targetPosition),c=D.useRef(t),u=n&&!!e.internals.handleBounds&&!e.hidden;return D.useEffect(()=>{i.current&&(!u||s.current!==i.current)&&(s.current&&(r==null||r.unobserve(s.current)),r==null||r.observe(i.current),s.current=i.current)},[u]),D.useEffect(()=>()=>{s.current&&(r==null||r.unobserve(s.current),s.current=null)},[]),D.useEffect(()=>{if(i.current){const f=c.current!==t,d=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(f||d||h)&&(c.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function yf({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:u,resizeObserver:f,noDragClassName:d,noPanClassName:h,disableKeyboardA11y:y,rfId:x,nodeTypes:v,nodeExtent:w,nodeOrigin:N,onError:p}){const{node:m,internals:M,isParent:b}=U(X=>{const Z=X.nodeLookup.get(e),W=X.parentLookup.has(e);return{node:Z,internals:Z.internals,isParent:W}},ee);let I=m.type||"default",E=(v==null?void 0:v[I])||Hr[I];E===void 0&&(p==null||p("003",ie.error003(I)),I="default",E=Hr.default);const k=!!(m.draggable||a&&typeof m.draggable>"u"),L=!!(m.selectable||l&&typeof m.selectable>"u"),z=!!(m.connectable||c&&typeof m.connectable>"u"),R=!!(m.focusable||u&&typeof m.focusable>"u"),H=Q(),g=Ro(m),S=mf({node:m,nodeType:I,hasDimensions:g,resizeObserver:f}),_=mi({nodeRef:S,disabled:m.hidden||!k,noDragClassName:d,handleSelector:m.dragHandle,nodeId:e,isSelectable:L}),T=yi();if(m.hidden)return null;const A=it(m),C=af(m),O=w?Tn(M.positionAbsolute,w):M.positionAbsolute,P=Cl({...O,...A,origin:m.origin||N}),V=L||k||t||n||r||o,B=n?X=>n(X,{...M.userNode}):void 0,F=r?X=>r(X,{...M.userNode}):void 0,Y=o?X=>o(X,{...M.userNode}):void 0,G=i?X=>i(X,{...M.userNode}):void 0,q=s?X=>s(X,{...M.userNode}):void 0,K=X=>{const{selectNodesOnDrag:Z,nodeDragThreshold:W}=H.getState();L&&(!Z||!k||W>0)&&Nn({id:e,store:H,nodeRef:S}),t&&t(X,{...M.userNode})},J=X=>{if(!(_n(X.nativeEvent)||y))if(Co.includes(X.key)&&L){const Z=X.key==="Escape";Nn({id:e,store:H,unselect:Z,nodeRef:S})}else k&&m.selected&&Object.prototype.hasOwnProperty.call(zt,X.key)&&(H.setState({ariaLiveMessage:`Moved selected node ${X.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~O.x}, y: ${~~O.y}`}),T({direction:zt[X.key],factor:X.shiftKey?4:1}))};return $.jsx("div",{className:te(["react-flow__node",`react-flow__node-${I}`,{[h]:k},m.className,{selected:m.selected,selectable:L,parent:b,draggable:k,dragging:_}]),ref:S,style:{zIndex:M.z,transform:`translate(${P.x}px,${P.y}px)`,pointerEvents:V?"all":"none",visibility:g?"visible":"hidden",...m.style,...C},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:B,onMouseMove:F,onMouseLeave:Y,onContextMenu:G,onClick:K,onDoubleClick:q,onKeyDown:R?J:void 0,tabIndex:R?0:void 0,role:R?"button":void 0,"aria-describedby":y?void 0:`${ci}-${x}`,"aria-label":m.ariaLabel,children:$.jsx(Qd,{value:e,children:$.jsx(E,{id:e,data:m.data,type:I,positionAbsoluteX:O.x,positionAbsoluteY:O.y,selected:m.selected,isConnectable:z,sourcePosition:m.sourcePosition,targetPosition:m.targetPosition,dragging:_,dragHandle:m.dragHandle,zIndex:M.z,...A})})})}const xf=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function vi(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:i}=U(xf,ee),s=hf(e.onlyRenderVisibleElements),a=pf();return $.jsx("div",{className:"react-flow__nodes",style:Kt,children:s.map(l=>$.jsx(yf,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,nodeOrigin:e.nodeOrigin,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:i},l))})}vi.displayName="NodeRenderer";const wf=D.memo(vi);function vf(e){return U(D.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const i=n.nodeLookup.get(o.source),s=n.nodeLookup.get(o.target);i&&s&&Al({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),ee)}const _f=({color:e="none",strokeWidth:t=1})=>$.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),bf=({color:e="none",strokeWidth:t=1})=>$.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Pr={[At.Arrow]:_f,[At.ArrowClosed]:bf};function Sf(e){const t=Q();return D.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(Pr,e)?Pr[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",ie.error009(e)),null)},[e])}const Ef=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const l=Sf(t);return l?$.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:$.jsx(l,{color:n,strokeWidth:s})}):null},_i=({defaultColor:e,rfId:t})=>{const n=U(i=>i.edges),r=U(i=>i.defaultEdgeOptions),o=D.useMemo(()=>Hl(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?$.jsx("svg",{className:"react-flow__marker",children:$.jsx("defs",{children:o.map(i=>$.jsx(Ef,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};_i.displayName="MarkerDefinitions";var Nf=D.memo(_i);function bi({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...u}){const[f,d]=D.useState({x:1,y:0,width:0,height:0}),h=te(["react-flow__edge-textwrapper",c]),y=D.useCallback(x=>{if(x===null)return;const v=x.getBBox();d({x:v.x,y:v.y,width:v.width,height:v.height})},[]);return typeof n>"u"||!n?null:$.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:h,visibility:f.width?"visible":"hidden",...u,children:[o&&$.jsx("rect",{width:f.width+2*s[0],x:-s[0],y:-s[1],height:f.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),$.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:y,style:r,children:n}),l]})}bi.displayName="EdgeText";const Mf=D.memo(bi);function Ut({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:u,markerEnd:f,markerStart:d,className:h,interactionWidth:y=20}){return $.jsxs($.Fragment,{children:[$.jsx("path",{id:e,style:u,d:t,fill:"none",className:te(["react-flow__edge-path",h]),markerEnd:f,markerStart:d}),y&&$.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),o&&de(n)&&de(r)?$.jsx(Mf,{x:n,y:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c}):null]})}function Vr({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===j.Left||e===j.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Si({sourceX:e,sourceY:t,sourcePosition:n=j.Bottom,targetX:r,targetY:o,targetPosition:i=j.Top}){const[s,a]=Vr({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,c]=Vr({pos:i,x1:r,y1:o,x2:e,y2:t}),[u,f,d,h]=Ho({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${s},${a} ${l},${c} ${r},${o}`,u,f,d,h]}function Ei(e){return D.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=j.Bottom,targetPosition:a=j.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:h,style:y,markerEnd:x,markerStart:v,interactionWidth:w})=>{const[N,p,m]=Si({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a}),M=e.isInternal?void 0:t;return $.jsx(Ut,{id:M,path:N,labelX:p,labelY:m,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:h,style:y,markerEnd:x,markerStart:v,interactionWidth:w})})}const Cf=Ei({isInternal:!1}),Ni=Ei({isInternal:!0});Cf.displayName="SimpleBezierEdge";Ni.displayName="SimpleBezierEdgeInternal";function Mi(e){return D.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:f,style:d,sourcePosition:h=j.Bottom,targetPosition:y=j.Top,markerEnd:x,markerStart:v,pathOptions:w,interactionWidth:N})=>{const[p,m,M]=bn({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:i,targetPosition:y,borderRadius:w==null?void 0:w.borderRadius,offset:w==null?void 0:w.offset}),b=e.isInternal?void 0:t;return $.jsx(Ut,{id:b,path:p,labelX:m,labelY:M,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:f,style:d,markerEnd:x,markerStart:v,interactionWidth:N})})}const Ci=Mi({isInternal:!1}),$i=Mi({isInternal:!0});Ci.displayName="SmoothStepEdge";$i.displayName="SmoothStepEdgeInternal";function Ii(e){return D.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return $.jsx(Ci,{...n,id:r,pathOptions:D.useMemo(()=>{var i;return{borderRadius:0,offset:(i=n.pathOptions)==null?void 0:i.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const $f=Ii({isInternal:!1}),Ai=Ii({isInternal:!0});$f.displayName="StepEdge";Ai.displayName="StepEdgeInternal";function ki(e){return D.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:f,style:d,markerEnd:h,markerStart:y,interactionWidth:x})=>{const[v,w,N]=Dl({sourceX:n,sourceY:r,targetX:o,targetY:i}),p=e.isInternal?void 0:t;return $.jsx(Ut,{id:p,path:v,labelX:w,labelY:N,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:f,style:d,markerEnd:h,markerStart:y,interactionWidth:x})})}const If=ki({isInternal:!1}),Ti=ki({isInternal:!0});If.displayName="StraightEdge";Ti.displayName="StraightEdgeInternal";function Di(e){return D.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=j.Bottom,targetPosition:a=j.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:h,style:y,markerEnd:x,markerStart:v,pathOptions:w,interactionWidth:N})=>{const[p,m,M]=Po({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a,curvature:w==null?void 0:w.curvature}),b=e.isInternal?void 0:t;return $.jsx(Ut,{id:b,path:p,labelX:m,labelY:M,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:h,style:y,markerEnd:x,markerStart:v,interactionWidth:N})})}const Af=Di({isInternal:!1}),Ri=Di({isInternal:!0});Af.displayName="BezierEdge";Ri.displayName="BezierEdgeInternal";const Br={default:Ri,straight:Ti,step:Ai,smoothstep:$i,simplebezier:Ni},Fr={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},kf=(e,t,n)=>n===j.Left?e-t:n===j.Right?e+t:e,Tf=(e,t,n)=>n===j.Top?e-t:n===j.Bottom?e+t:e,jr="react-flow__edgeupdater";function Yr({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a}){return $.jsx("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:te([jr,`${jr}-${a}`]),cx:kf(t,r,e),cy:Tf(n,r,e),r,stroke:"transparent",fill:"transparent"})}function Df({isUpdatable:e,edgeUpdaterRadius:t,edge:n,targetHandleId:r,sourceHandleId:o,sourceX:i,sourceY:s,targetX:a,targetY:l,sourcePosition:c,targetPosition:u,onEdgeUpdate:f,onEdgeUpdateStart:d,onEdgeUpdateEnd:h,setUpdating:y,setUpdateHover:x}){const v=Q(),w=(b,I)=>{if(b.button!==0)return;const{autoPanOnConnect:E,domNode:k,isValidConnection:L,connectionMode:z,connectionRadius:R,lib:H,onConnectStart:g,onConnectEnd:S,cancelConnection:_,nodeLookup:T,rfId:A,panBy:C,updateConnection:O}=v.getState(),P=I?n.target:n.source,V=(I?r:o)||null,B=I?"target":"source",F=I;y(!0),d==null||d(b,n,B);const Y=q=>{y(!1),h==null||h(q,n,B)},G=q=>f==null?void 0:f(n,q);En.onPointerDown(b.nativeEvent,{autoPanOnConnect:E,connectionMode:z,connectionRadius:R,domNode:k,handleId:V,nodeId:P,nodeLookup:T,isTarget:F,edgeUpdaterType:B,lib:H,flowId:A,cancelConnection:_,panBy:C,isValidConnection:L,onConnect:G,onConnectStart:g,onConnectEnd:S,onEdgeUpdateEnd:Y,updateConnection:O,getTransform:()=>v.getState().transform,getConnectionStartHandle:()=>v.getState().connectionStartHandle})},N=b=>w(b,!0),p=b=>w(b,!1),m=()=>x(!0),M=()=>x(!1);return $.jsxs($.Fragment,{children:[(e==="source"||e===!0)&&$.jsx(Yr,{position:c,centerX:i,centerY:s,radius:t,onMouseDown:N,onMouseEnter:m,onMouseOut:M,type:"source"}),(e==="target"||e===!0)&&$.jsx(Yr,{position:u,centerX:a,centerY:l,radius:t,onMouseDown:p,onMouseEnter:m,onMouseOut:M,type:"target"})]})}function Rf({id:e,edgesFocusable:t,edgesUpdatable:n,elementsSelectable:r,onClick:o,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,edgeUpdaterRadius:u,onEdgeUpdate:f,onEdgeUpdateStart:d,onEdgeUpdateEnd:h,rfId:y,edgeTypes:x,noPanClassName:v,onError:w,disableKeyboardA11y:N}){let p=U(W=>W.edgeLookup.get(e));const m=U(W=>W.defaultEdgeOptions);p=m?{...m,...p}:p;let M=p.type||"default",b=(x==null?void 0:x[M])||Br[M];b===void 0&&(w==null||w("011",ie.error011(M)),M="default",b=Br.default);const I=!!(p.focusable||t&&typeof p.focusable>"u"),E=typeof f<"u"&&(p.updatable||n&&typeof p.updatable>"u"),k=!!(p.selectable||r&&typeof p.selectable>"u"),L=D.useRef(null),[z,R]=D.useState(!1),[H,g]=D.useState(!1),S=Q(),{zIndex:_,sourceX:T,sourceY:A,targetX:C,targetY:O,sourcePosition:P,targetPosition:V}=U(D.useCallback(W=>{const re=W.nodeLookup.get(p.source),ne=W.nodeLookup.get(p.target);if(!re||!ne)return{zIndex:p.zIndex,...Fr};const ge=Ol({id:e,sourceNode:re,targetNode:ne,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:W.connectionMode,onError:w});return{zIndex:Il({selected:p.selected,zIndex:p.zIndex,sourceNode:re,targetNode:ne,elevateOnSelect:W.elevateEdgesOnSelect}),...ge||Fr}},[p.source,p.target,p.sourceHandle,p.targetHandle,p.selected,p.zIndex]),ee),B=D.useMemo(()=>p.markerStart?`url('#${Sn(p.markerStart,y)}')`:void 0,[p.markerStart,y]),F=D.useMemo(()=>p.markerEnd?`url('#${Sn(p.markerEnd,y)}')`:void 0,[p.markerEnd,y]);if(p.hidden||T===null||A===null||C===null||O===null)return null;const Y=W=>{var we;const{addSelectedEdges:re,unselectNodesAndEdges:ne,multiSelectionActive:ge}=S.getState();k&&(S.setState({nodesSelectionActive:!1}),p.selected&&ge?(ne({nodes:[],edges:[p]}),(we=L.current)==null||we.blur()):re([e])),o&&o(W,p)},G=i?W=>{i(W,{...p})}:void 0,q=s?W=>{s(W,{...p})}:void 0,K=a?W=>{a(W,{...p})}:void 0,J=l?W=>{l(W,{...p})}:void 0,X=c?W=>{c(W,{...p})}:void 0,Z=W=>{var re;if(!N&&Co.includes(W.key)&&k){const{unselectNodesAndEdges:ne,addSelectedEdges:ge}=S.getState();W.key==="Escape"?((re=L.current)==null||re.blur(),ne({edges:[p]})):ge([e])}};return $.jsx("svg",{style:{zIndex:_},children:$.jsxs("g",{className:te(["react-flow__edge",`react-flow__edge-${M}`,p.className,v,{selected:p.selected,animated:p.animated,inactive:!k&&!o,updating:z,selectable:k}]),onClick:Y,onDoubleClick:G,onContextMenu:q,onMouseEnter:K,onMouseMove:J,onMouseLeave:X,onKeyDown:I?Z:void 0,tabIndex:I?0:void 0,role:I?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":p.ariaLabel===null?void 0:p.ariaLabel||`Edge from ${p.source} to ${p.target}`,"aria-describedby":I?`${ui}-${y}`:void 0,ref:L,children:[!H&&$.jsx(b,{id:e,source:p.source,target:p.target,type:p.type,selected:p.selected,animated:p.animated,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,sourceX:T,sourceY:A,targetX:C,targetY:O,sourcePosition:P,targetPosition:V,data:p.data,style:p.style,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerStart:B,markerEnd:F,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth}),E&&$.jsx(Df,{edge:p,isUpdatable:E,edgeUpdaterRadius:u,onEdgeUpdate:f,onEdgeUpdateStart:d,onEdgeUpdateEnd:h,sourceX:T,sourceY:A,targetX:C,targetY:O,sourcePosition:P,targetPosition:V,setUpdateHover:R,setUpdating:g,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle})]})})}const Lf=e=>({width:e.width,height:e.height,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Li({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onEdgeUpdate:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:u,edgeUpdaterRadius:f,onEdgeDoubleClick:d,onEdgeUpdateStart:h,onEdgeUpdateEnd:y,disableKeyboardA11y:x}){const{edgesFocusable:v,edgesUpdatable:w,elementsSelectable:N,onError:p}=U(Lf,ee),m=vf(t);return $.jsxs("div",{className:"react-flow__edges",children:[$.jsx(Nf,{defaultColor:e,rfId:n}),m.map(M=>$.jsx(Rf,{id:M,edgesFocusable:v,edgesUpdatable:w,elementsSelectable:N,noPanClassName:o,onEdgeUpdate:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:u,edgeUpdaterRadius:f,onDoubleClick:d,onEdgeUpdateStart:h,onEdgeUpdateEnd:y,rfId:n,onError:p,edgeTypes:r,disableKeyboardA11y:x},M))]})}Li.displayName="EdgeRenderer";const zf=D.memo(Li),Of=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Hf({children:e}){const t=U(Of);return $.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Pf(e){const t=On(),n=D.useRef(!1);D.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Vf=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Bf(e){const t=U(Vf),n=Q();return D.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}const Ff={[j.Left]:j.Right,[j.Right]:j.Left,[j.Top]:j.Bottom,[j.Bottom]:j.Top},zi=({nodeId:e,handleType:t,style:n,type:r=Se.Bezier,CustomComponent:o,connectionStatus:i})=>{const{fromNode:s,handleId:a,toX:l,toY:c,connectionMode:u}=U(D.useCallback(b=>{var I;return{fromNode:b.nodeLookup.get(e),handleId:(I=b.connectionStartHandle)==null?void 0:I.handleId,toX:(b.connectionPosition.x-b.transform[0])/b.transform[2],toY:(b.connectionPosition.y-b.transform[1])/b.transform[2],connectionMode:b.connectionMode}},[e]),ee),f=s==null?void 0:s.internals.handleBounds;let d=f==null?void 0:f[t];if(u===Ae.Loose&&(d=d||(f==null?void 0:f[t==="source"?"target":"source"])),!s||!d)return null;const h=a?d.find(b=>b.id===a):d[0],y=h?h.x+h.width/2:(s.measured.width??0)/2,x=h?h.y+h.height/2:s.measured.height??0,v=s.internals.positionAbsolute.x+y,w=s.internals.positionAbsolute.y+x,N=h==null?void 0:h.position,p=N?Ff[N]:null;if(!N||!p)return null;if(o)return $.jsx(o,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:h,fromX:v,fromY:w,toX:l,toY:c,fromPosition:N,toPosition:p,connectionStatus:i});let m="";const M={sourceX:v,sourceY:w,sourcePosition:N,targetX:l,targetY:c,targetPosition:p};return r===Se.Bezier?[m]=Po(M):r===Se.Step?[m]=bn({...M,borderRadius:0}):r===Se.SmoothStep?[m]=bn(M):r===Se.SimpleBezier?[m]=Si(M):m=`M${v},${w} ${l},${c}`,$.jsx("path",{d:m,fill:"none",className:"react-flow__connection-path",style:n})};zi.displayName="ConnectionLine";const jf=e=>{var t,n;return{nodeId:(t=e.connectionStartHandle)==null?void 0:t.nodeId,handleType:(n=e.connectionStartHandle)==null?void 0:n.type,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height}};function Yf({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:i,nodesConnectable:s,width:a,height:l,connectionStatus:c}=U(jf,ee);return!(o&&i&&a&&s)?null:$.jsx("svg",{style:e,width:a,height:l,className:"react-flow__connectionline react-flow__container",children:$.jsx("g",{className:te(["react-flow__connection",c]),children:$.jsx(zi,{nodeId:o,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:c})})})}const Xf={};function Xr(e=Xf){const t=D.useRef(e),n=Q();D.useEffect(()=>{var r,o;{const i=new Set([...Object.keys(t.current),...Object.keys(e)]);for(const s of i)if(t.current[s]!==e[s]){(o=(r=n.getState()).onError)==null||o.call(r,"002",ie.error002());break}t.current=e}},[e])}function Wf(){const e=Q(),t=D.useRef(!1);D.useEffect(()=>{var n,r;if(!t.current){const o=document.querySelector(".react-flow__pane");o&&window.getComputedStyle(o).zIndex!=="1"&&((r=(n=e.getState()).onError)==null||r.call(n,"013",ie.error013("react"))),t.current=!0}},[])}function Oi({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,onSelectionContextMenu:f,onSelectionStart:d,onSelectionEnd:h,connectionLineType:y,connectionLineStyle:x,connectionLineComponent:v,connectionLineContainerStyle:w,selectionKeyCode:N,selectionOnDrag:p,selectionMode:m,multiSelectionKeyCode:M,panActivationKeyCode:b,zoomActivationKeyCode:I,deleteKeyCode:E,onlyRenderVisibleElements:k,elementsSelectable:L,defaultViewport:z,translateExtent:R,minZoom:H,maxZoom:g,preventScrolling:S,defaultMarkerColor:_,zoomOnScroll:T,zoomOnPinch:A,panOnScroll:C,panOnScrollSpeed:O,panOnScrollMode:P,zoomOnDoubleClick:V,panOnDrag:B,onPaneClick:F,onPaneMouseEnter:Y,onPaneMouseMove:G,onPaneMouseLeave:q,onPaneScroll:K,onPaneContextMenu:J,onEdgeUpdate:X,onEdgeContextMenu:Z,onEdgeMouseEnter:W,onEdgeMouseMove:re,onEdgeMouseLeave:ne,edgeUpdaterRadius:ge,onEdgeUpdateStart:we,onEdgeUpdateEnd:Zt,noDragClassName:st,noWheelClassName:Qt,noPanClassName:ke,disableKeyboardA11y:Ve,nodeOrigin:Jt,nodeExtent:en,rfId:at,viewport:Be,onViewportChange:ct}){return Xr(e),Xr(t),Wf(),Pf(n),Bf(Be),$.jsx(df,{onPaneClick:F,onPaneMouseEnter:Y,onPaneMouseMove:G,onPaneMouseLeave:q,onPaneContextMenu:J,onPaneScroll:K,deleteKeyCode:E,selectionKeyCode:N,selectionOnDrag:p,selectionMode:m,onSelectionStart:d,onSelectionEnd:h,multiSelectionKeyCode:M,panActivationKeyCode:b,zoomActivationKeyCode:I,elementsSelectable:L,zoomOnScroll:T,zoomOnPinch:A,zoomOnDoubleClick:V,panOnScroll:C,panOnScrollSpeed:O,panOnScrollMode:P,panOnDrag:B,defaultViewport:z,translateExtent:R,minZoom:H,maxZoom:g,onSelectionContextMenu:f,preventScrolling:S,noDragClassName:st,noWheelClassName:Qt,noPanClassName:ke,disableKeyboardA11y:Ve,onViewportChange:ct,isControlledViewport:!!Be,children:$.jsxs(Hf,{children:[$.jsx(zf,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:s,onEdgeUpdate:X,onlyRenderVisibleElements:k,onEdgeContextMenu:Z,onEdgeMouseEnter:W,onEdgeMouseMove:re,onEdgeMouseLeave:ne,onEdgeUpdateStart:we,onEdgeUpdateEnd:Zt,edgeUpdaterRadius:ge,defaultMarkerColor:_,noPanClassName:ke,disableKeyboardA11y:Ve,rfId:at}),$.jsx(Yf,{style:x,type:y,component:v,containerStyle:w}),$.jsx("div",{className:"react-flow__edgelabel-renderer"}),$.jsx(wf,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,onlyRenderVisibleElements:k,noPanClassName:ke,noDragClassName:st,disableKeyboardA11y:Ve,nodeOrigin:Jt,nodeExtent:en,rfId:at}),$.jsx("div",{className:"react-flow__viewport-portal"})]})})}Oi.displayName="GraphView";const Gf=D.memo(Oi),Wr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s}={})=>{const a=new Map,l=new Map,c=new Map,u=new Map,f=r??t??[],d=n??e??[];Wo(c,u,f),Yo(d,a,l,{nodeOrigin:[0,0],elevateNodesOnSelect:!1});let h=[0,0,1];if(s&&o&&i){const y=Ft(a,{nodeOrigin:[0,0],filter:N=>!!((N.width||N.initialWidth)&&(N.height||N.initialHeight))}),{x,y:v,zoom:w}=Dn(y,o,i,.5,2,.1);h=[x,v,w]}return{rfId:"1",width:0,height:0,transform:h,nodes:d,nodeLookup:a,parentLookup:l,edges:f,edgeLookup:u,connectionLookup:c,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:It,nodeExtent:It,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ae.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Dt,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},qf=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s})=>md((a,l)=>({...Wr({nodes:e,edges:t,width:o,height:i,fitView:s,defaultNodes:n,defaultEdges:r}),setNodes:c=>{const{nodeLookup:u,parentLookup:f,nodeOrigin:d,elevateNodesOnSelect:h}=l();Yo(c,u,f,{nodeOrigin:d,elevateNodesOnSelect:h,checkEquality:!0}),a({nodes:c})},setEdges:c=>{const{connectionLookup:u,edgeLookup:f}=l();Wo(u,f,c),a({edges:c})},setDefaultNodesAndEdges:(c,u)=>{if(c){const{setNodes:f}=l();f(c),a({hasDefaultNodes:!0})}if(u){const{setEdges:f}=l();f(u),a({hasDefaultEdges:!0})}},updateNodeInternals:c=>{const{triggerNodeChanges:u,fitView:f,nodeLookup:d,parentLookup:h,fitViewOnInit:y,fitViewDone:x,fitViewOnInitOptions:v,domNode:w,nodeOrigin:N,debug:p}=l(),{changes:m,updatedInternals:M}=Pl(c,d,h,w,N);if(!M)return;jo(d,{nodeOrigin:N});let b=x;!x&&y&&(b=f({...v,nodes:v==null?void 0:v.nodes})),a({fitViewDone:b}),(m==null?void 0:m.length)>0&&(p&&console.log("React Flow: trigger node changes",m),u==null||u(m))},updateNodePositions:(c,u=!1)=>{const f=[],d=[];for(const[h,y]of c){const x={id:h,type:"position",position:y.position,dragging:u};y!=null&&y.expandParent&&(y!=null&&y.parentId)&&x.position&&(f.push({id:h,parentId:y.parentId,rect:{...y.internals.positionAbsolute,width:y.measured.width,height:y.measured.height}}),x.position.x=Math.max(0,x.position.x),x.position.y=Math.max(0,x.position.y)),d.push(x)}if(f.length>0){const{nodeLookup:h,parentLookup:y}=l(),x=Ln(f,h,y);d.push(...x)}l().triggerNodeChanges(d)},triggerNodeChanges:c=>{const{onNodesChange:u,setNodes:f,nodes:d,hasDefaultNodes:h,debug:y}=l();if(c!=null&&c.length){if(h){const x=fi(c,d);f(x)}y&&console.log("React Flow: trigger node changes",c),u==null||u(c)}},triggerEdgeChanges:c=>{const{onEdgesChange:u,setEdges:f,edges:d,hasDefaultEdges:h,debug:y}=l();if(c!=null&&c.length){if(h){const x=hi(c,d);f(x)}y&&console.log("React Flow: trigger edge changes",c),u==null||u(c)}},addSelectedNodes:c=>{const{multiSelectionActive:u,edgeLookup:f,nodeLookup:d,triggerNodeChanges:h,triggerEdgeChanges:y}=l();if(u){const x=c.map(v=>Ne(v,!0));h(x);return}h(De(d,new Set([...c]),!0)),y(De(f))},addSelectedEdges:c=>{const{multiSelectionActive:u,edgeLookup:f,nodeLookup:d,triggerNodeChanges:h,triggerEdgeChanges:y}=l();if(u){const x=c.map(v=>Ne(v,!0));y(x);return}y(De(f,new Set([...c]))),h(De(d,new Set,!0))},unselectNodesAndEdges:({nodes:c,edges:u}={})=>{const{edges:f,nodes:d,triggerNodeChanges:h,triggerEdgeChanges:y}=l(),x=c||d,v=u||f,w=x.map(p=>(p.selected=!1,Ne(p.id,!1))),N=v.map(p=>Ne(p.id,!1));h(w),y(N)},setMinZoom:c=>{const{panZoom:u,maxZoom:f}=l();u==null||u.setScaleExtent([c,f]),a({minZoom:c})},setMaxZoom:c=>{const{panZoom:u,minZoom:f}=l();u==null||u.setScaleExtent([f,c]),a({maxZoom:c})},setTranslateExtent:c=>{var u;(u=l().panZoom)==null||u.setTranslateExtent(c),a({translateExtent:c})},resetSelectedElements:()=>{const{edges:c,nodes:u,triggerNodeChanges:f,triggerEdgeChanges:d}=l(),h=u.reduce((x,v)=>v.selected?[...x,Ne(v.id,!1)]:x,[]),y=c.reduce((x,v)=>v.selected?[...x,Ne(v.id,!1)]:x,[]);f(h),d(y)},setNodeExtent:c=>{const{nodeLookup:u}=l();for(const[,f]of u){const d=Tn(f.position,c);u.set(f.id,{...f,internals:{...f.internals,positionAbsolute:d}})}a({nodeExtent:c})},panBy:c=>{const{transform:u,width:f,height:d,panZoom:h,translateExtent:y}=l();return Vl({delta:c,panZoom:h,transform:u,translateExtent:y,width:f,height:d})},fitView:c=>{const{panZoom:u,width:f,height:d,minZoom:h,maxZoom:y,nodeOrigin:x,nodeLookup:v}=l();return u?Io({nodeLookup:v,width:f,height:d,panZoom:u,minZoom:h,maxZoom:y,nodeOrigin:x},c):!1},cancelConnection:()=>a({connectionStatus:null,connectionStartHandle:null,connectionEndHandle:null}),updateConnection:c=>{const{connectionPosition:u}=l(),f={...c,connectionPosition:c.connectionPosition??u};a(f)},reset:()=>a({...Wr()})}),Object.is);function Kf({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:i,fitView:s,children:a}){const[l]=D.useState(()=>qf({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s}));return $.jsx(yd,{value:l,children:$.jsx(Pd,{children:a})})}function Uf({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:i,height:s,fitView:a}){return D.useContext(qt)?$.jsx($.Fragment,{children:e}):$.jsx(Kf,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:i,initialHeight:s,fitView:a,children:e})}const Zf={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Qf({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:u,onMoveStart:f,onMoveEnd:d,onConnect:h,onConnectStart:y,onConnectEnd:x,onClickConnectStart:v,onClickConnectEnd:w,onNodeMouseEnter:N,onNodeMouseMove:p,onNodeMouseLeave:m,onNodeContextMenu:M,onNodeDoubleClick:b,onNodeDragStart:I,onNodeDrag:E,onNodeDragStop:k,onNodesDelete:L,onEdgesDelete:z,onDelete:R,onSelectionChange:H,onSelectionDragStart:g,onSelectionDrag:S,onSelectionDragStop:_,onSelectionContextMenu:T,onSelectionStart:A,onSelectionEnd:C,onBeforeDelete:O,connectionMode:P,connectionLineType:V=Se.Bezier,connectionLineStyle:B,connectionLineComponent:F,connectionLineContainerStyle:Y,deleteKeyCode:G="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:K=!1,selectionMode:J=Je.Full,panActivationKeyCode:X="Space",multiSelectionKeyCode:Z=Rt()?"Meta":"Control",zoomActivationKeyCode:W=Rt()?"Meta":"Control",snapToGrid:re,snapGrid:ne,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:we,nodesDraggable:Zt,nodesConnectable:st,nodesFocusable:Qt,nodeOrigin:ke=li,edgesFocusable:Ve,edgesUpdatable:Jt,elementsSelectable:en=!0,defaultViewport:at=Ad,minZoom:Be=.5,maxZoom:ct=2,translateExtent:Pn=It,preventScrolling:Fi=!0,nodeExtent:Vn,defaultMarkerColor:ji="#b1b1b7",zoomOnScroll:Yi=!0,zoomOnPinch:Xi=!0,panOnScroll:Wi=!1,panOnScrollSpeed:Gi=.5,panOnScrollMode:qi=$e.Free,zoomOnDoubleClick:Ki=!0,panOnDrag:Ui=!0,onPaneClick:Zi,onPaneMouseEnter:Qi,onPaneMouseMove:Ji,onPaneMouseLeave:es,onPaneScroll:ts,onPaneContextMenu:ns,children:rs,onEdgeUpdate:os,onEdgeContextMenu:is,onEdgeDoubleClick:ss,onEdgeMouseEnter:as,onEdgeMouseMove:cs,onEdgeMouseLeave:us,onEdgeUpdateStart:ls,onEdgeUpdateEnd:ds,edgeUpdaterRadius:fs=10,onNodesChange:hs,onEdgesChange:gs,noDragClassName:ps="nodrag",noWheelClassName:ms="nowheel",noPanClassName:Bn="nopan",fitView:Fn,fitViewOptions:ys,connectOnClick:xs,attributionPosition:ws,proOptions:vs,defaultEdgeOptions:_s,elevateNodesOnSelect:bs,elevateEdgesOnSelect:Ss,disableKeyboardA11y:jn=!1,autoPanOnConnect:Es,autoPanOnNodeDrag:Ns,connectionRadius:Ms,isValidConnection:Cs,onError:$s,style:Is,id:Yn,nodeDragThreshold:As,viewport:ks,onViewportChange:Ts,width:Ds,height:Rs,colorMode:Ls="light",debug:zs,...Os},Hs){const tn=Yn||"1",Ps=Rd(Ls);return $.jsx("div",{...Os,style:{...Is,...Zf},ref:Hs,className:te(["react-flow",o,Ps]),"data-testid":"rf__wrapper",id:Yn,children:$.jsxs(Uf,{nodes:e,edges:t,width:Ds,height:Rs,fitView:Fn,children:[$.jsx(Gf,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:N,onNodeMouseMove:p,onNodeMouseLeave:m,onNodeContextMenu:M,onNodeDoubleClick:b,nodeTypes:i,edgeTypes:s,connectionLineType:V,connectionLineStyle:B,connectionLineComponent:F,connectionLineContainerStyle:Y,selectionKeyCode:q,selectionOnDrag:K,selectionMode:J,deleteKeyCode:G,multiSelectionKeyCode:Z,panActivationKeyCode:X,zoomActivationKeyCode:W,onlyRenderVisibleElements:ge,defaultViewport:at,translateExtent:Pn,minZoom:Be,maxZoom:ct,preventScrolling:Fi,zoomOnScroll:Yi,zoomOnPinch:Xi,zoomOnDoubleClick:Ki,panOnScroll:Wi,panOnScrollSpeed:Gi,panOnScrollMode:qi,panOnDrag:Ui,onPaneClick:Zi,onPaneMouseEnter:Qi,onPaneMouseMove:Ji,onPaneMouseLeave:es,onPaneScroll:ts,onPaneContextMenu:ns,onSelectionContextMenu:T,onSelectionStart:A,onSelectionEnd:C,onEdgeUpdate:os,onEdgeContextMenu:is,onEdgeDoubleClick:ss,onEdgeMouseEnter:as,onEdgeMouseMove:cs,onEdgeMouseLeave:us,onEdgeUpdateStart:ls,onEdgeUpdateEnd:ds,edgeUpdaterRadius:fs,defaultMarkerColor:ji,noDragClassName:ps,noWheelClassName:ms,noPanClassName:Bn,rfId:tn,disableKeyboardA11y:jn,nodeOrigin:ke,nodeExtent:Vn,viewport:ks,onViewportChange:Ts}),$.jsx(Dd,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:y,onConnectEnd:x,onClickConnectStart:v,onClickConnectEnd:w,nodesDraggable:Zt,nodesConnectable:st,nodesFocusable:Qt,edgesFocusable:Ve,edgesUpdatable:Jt,elementsSelectable:en,elevateNodesOnSelect:bs,elevateEdgesOnSelect:Ss,minZoom:Be,maxZoom:ct,nodeExtent:Vn,onNodesChange:hs,onEdgesChange:gs,snapToGrid:re,snapGrid:ne,connectionMode:P,translateExtent:Pn,connectOnClick:xs,defaultEdgeOptions:_s,fitView:Fn,fitViewOptions:ys,onNodesDelete:L,onEdgesDelete:z,onDelete:R,onNodeDragStart:I,onNodeDrag:E,onNodeDragStop:k,onSelectionDrag:S,onSelectionDragStart:g,onSelectionDragStop:_,onMove:u,onMoveStart:f,onMoveEnd:d,noPanClassName:Bn,nodeOrigin:ke,rfId:tn,autoPanOnConnect:Es,autoPanOnNodeDrag:Ns,onError:$s,connectionRadius:Ms,isValidConnection:Cs,selectNodesOnDrag:we,nodeDragThreshold:As,onBeforeDelete:O,debug:zs}),$.jsx(Id,{onSelectionChange:H}),rs,$.jsx(Ed,{proOptions:vs,position:ws}),$.jsx(bd,{rfId:tn,disableKeyboardA11y:jn})]})})}var Oh=gi(Qf);const Jf=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__edgelabel-renderer")};function Hh({children:e}){const t=U(Jf);return t?Bs.createPortal(e,t):null}function Ph(){const e=Q();return D.useCallback(t=>{const{domNode:n,updateNodeInternals:r}=e.getState(),o=Array.isArray(t)?t:[t],i=new Map;o.forEach(s=>{const a=n==null?void 0:n.querySelector(`.react-flow__node[data-id="${s}"]`);a&&i.set(s,{id:s,nodeElement:a,force:!0})}),requestAnimationFrame(()=>r(i))},[])}function Vh(e){return U(D.useCallback(n=>{const r=[],o=Array.isArray(e),i=o?e:[e];for(const s of i){const a=n.nodeLookup.get(s);a&&r.push({id:a.id,type:a.type,data:a.data})}return o?r:r[0]??null},[e]),Bl)}function eh({dimensions:e,lineWidth:t,variant:n,className:r}){return $.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:te(["react-flow__background-pattern",n,r])})}function th({radius:e,className:t}){return $.jsx("circle",{cx:e,cy:e,r:e,className:te(["react-flow__background-pattern","dots",t])})}var Ee;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ee||(Ee={}));const nh={[Ee.Dots]:1,[Ee.Lines]:1,[Ee.Cross]:6},rh=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Hi({id:e,variant:t=Ee.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=2,color:s,bgColor:a,style:l,className:c,patternClassName:u}){const f=D.useRef(null),{transform:d,patternId:h}=U(rh,ee),y=r||nh[t],x=t===Ee.Dots,v=t===Ee.Cross,w=Array.isArray(n)?n:[n,n],N=[w[0]*d[2]||1,w[1]*d[2]||1],p=y*d[2],m=v?[p,p]:N,M=x?[p/i,p/i]:[m[0]/i,m[1]/i],b=`${h}${e||""}`;return $.jsxs("svg",{className:te(["react-flow__background",c]),style:{...l,...Kt,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:f,"data-testid":"rf__background",children:[$.jsx("pattern",{id:b,x:d[0]%N[0],y:d[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${M[0]},-${M[1]})`,children:x?$.jsx(th,{radius:p/i,className:u}):$.jsx(eh,{dimensions:m,lineWidth:o,variant:t,className:u})}),$.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${b})`})]})}Hi.displayName="Background";const Bh=D.memo(Hi);function oh(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:$.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function ih(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:$.jsx("path",{d:"M0 0h32v4.2H0z"})})}function sh(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:$.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function ah(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:$.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function ch(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:$.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function xt({children:e,className:t,...n}){return $.jsx("button",{type:"button",className:te(["react-flow__controls-button",t]),...n,children:e})}const uh=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Pi({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:c,children:u,position:f="bottom-left",orientation:d="vertical","aria-label":h="React Flow controls"}){const y=Q(),{isInteractive:x,minZoomReached:v,maxZoomReached:w}=U(uh,ee),{zoomIn:N,zoomOut:p,fitView:m}=On(),M=()=>{N(),i==null||i()},b=()=>{p(),s==null||s()},I=()=>{m(o),a==null||a()},E=()=>{y.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),l==null||l(!x)},k=d==="horizontal"?"horizontal":"vertical";return $.jsxs(zn,{className:te(["react-flow__controls",k,c]),position:f,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&$.jsxs($.Fragment,{children:[$.jsx(xt,{onClick:M,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:w,children:$.jsx(oh,{})}),$.jsx(xt,{onClick:b,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:$.jsx(ih,{})})]}),n&&$.jsx(xt,{className:"react-flow__controls-fitview",onClick:I,title:"fit view","aria-label":"fit view",children:$.jsx(sh,{})}),r&&$.jsx(xt,{className:"react-flow__controls-interactive",onClick:E,title:"toggle interactivity","aria-label":"toggle interactivity",children:x?$.jsx(ch,{}):$.jsx(ah,{})}),u]})}Pi.displayName="Controls";const Fh=D.memo(Pi);function lh({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:l,className:c,borderRadius:u,shapeRendering:f,selected:d,onClick:h}){const{background:y,backgroundColor:x}=i||{},v=s||y||x;return $.jsx("rect",{className:te(["react-flow__minimap-node",{selected:d},c]),x:t,y:n,rx:u,ry:u,width:r,height:o,style:{fill:v,stroke:a,strokeWidth:l},shapeRendering:f,onClick:h?w=>h(w,e):void 0})}const dh=D.memo(lh),fh=e=>e.nodeOrigin,hh=e=>e.nodes.map(t=>t.id),dn=e=>e instanceof Function?e:()=>e;function gh({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:i=dh,onClick:s}){const a=U(hh,ee),l=U(fh),c=dn(t),u=dn(e),f=dn(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return $.jsx($.Fragment,{children:a.map(h=>$.jsx(mh,{id:h,nodeOrigin:l,nodeColorFunc:c,nodeStrokeColorFunc:u,nodeClassNameFunc:f,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:i,onClick:s,shapeRendering:d},h))})}function ph({id:e,nodeOrigin:t,nodeColorFunc:n,nodeStrokeColorFunc:r,nodeClassNameFunc:o,nodeBorderRadius:i,nodeStrokeWidth:s,shapeRendering:a,NodeComponent:l,onClick:c}){const{node:u,x:f,y:d}=U(x=>{const v=x.nodeLookup.get(e),{x:w,y:N}=Pe(v,t).positionAbsolute;return{node:v,x:w,y:N}},ee);if(!u||u.hidden||!Ro(u))return null;const{width:h,height:y}=it(u);return $.jsx(l,{x:f,y:d,width:h,height:y,style:u.style,selected:!!u.selected,className:o(u),color:n(u),borderRadius:i,strokeColor:r(u),strokeWidth:s,shapeRendering:a,onClick:c,id:u.id})}const mh=D.memo(ph);var yh=D.memo(gh);const xh=200,wh=150,vh=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?To(Ft(e.nodeLookup,{nodeOrigin:e.nodeOrigin}),t):t,rfId:e.rfId,nodeOrigin:e.nodeOrigin,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},_h="react-flow__minimap-desc";function Vi({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:u,maskStrokeWidth:f,position:d="bottom-right",onClick:h,onNodeClick:y,pannable:x=!1,zoomable:v=!1,ariaLabel:w="React Flow mini map",inversePan:N,zoomStep:p=10,offsetScale:m=5}){const M=Q(),b=D.useRef(null),{boundingRect:I,viewBB:E,rfId:k,panZoom:L,translateExtent:z,flowWidth:R,flowHeight:H}=U(vh,ee),g=(e==null?void 0:e.width)??xh,S=(e==null?void 0:e.height)??wh,_=I.width/g,T=I.height/S,A=Math.max(_,T),C=A*g,O=A*S,P=m*A,V=I.x-(C-I.width)/2-P,B=I.y-(O-I.height)/2-P,F=C+P*2,Y=O+P*2,G=`${_h}-${k}`,q=D.useRef(0),K=D.useRef();q.current=A,D.useEffect(()=>{if(b.current&&L)return K.current=ql({domNode:b.current,panZoom:L,getTransform:()=>M.getState().transform,getViewScale:()=>q.current}),()=>{var Z;(Z=K.current)==null||Z.destroy()}},[L]),D.useEffect(()=>{var Z;(Z=K.current)==null||Z.update({translateExtent:z,width:R,height:H,inversePan:N,pannable:x,zoomStep:p,zoomable:v})},[x,v,N,p,z,R,H]);const J=h?Z=>{var ne;const[W,re]=((ne=K.current)==null?void 0:ne.pointer(Z))||[0,0];h(Z,{x:W,y:re})}:void 0,X=y?D.useCallback((Z,W)=>{const re=M.getState().nodeLookup.get(W);y(Z,re)},[]):void 0;return $.jsx(zn,{position:d,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*A:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="string"?s:void 0},className:te(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:$.jsxs("svg",{width:g,height:S,viewBox:`${V} ${B} ${F} ${Y}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":G,ref:b,onClick:J,children:[w&&$.jsx("title",{id:G,children:w}),$.jsx(yh,{onClick:X,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:s,nodeComponent:a}),$.jsx("path",{className:"react-flow__minimap-mask",d:`M${V-P},${B-P}h${F+P*2}v${Y+P*2}h${-F-P*2}z
        M${E.x},${E.y}h${E.width}v${E.height}h${-E.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Vi.displayName="MiniMap";const jh=D.memo(Vi);function bh({nodeId:e,position:t,variant:n=Ge.Handle,className:r,style:o={},children:i,color:s,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:f=!1,shouldResize:d,onResizeStart:h,onResize:y,onResizeEnd:x}){const v=xi(),w=typeof e=="string"?e:v,N=Q(),p=D.useRef(null),m=n===Ge.Line?"right":"bottom-right",M=t??m,b=D.useRef(null);D.useEffect(()=>{if(!(!p.current||!w))return b.current||(b.current=ud({domNode:p.current,nodeId:w,getStoreItems:()=>{const{nodeLookup:L,transform:z,snapGrid:R,snapToGrid:H,nodeOrigin:g}=N.getState();return{nodeLookup:L,transform:z,snapGrid:R,snapToGrid:H,nodeOrigin:g}},onChange:(L,z)=>{const{triggerNodeChanges:R,nodeLookup:H,parentLookup:g,nodeOrigin:S}=N.getState(),_=[],T={x:L.x,y:L.y},A=H.get(w);if(A&&A.expandParent&&A.parentId){const C={id:A.id,parentId:A.parentId,rect:{width:L.width??A.measured.width,height:L.height??A.measured.height,...Lo({x:L.x??A.position.x,y:L.y??A.position.y},A.parentId,H,A.origin??S)}},O=Ln([C],H,g,S);_.push(...O),T.x=L.x?Math.max(0,L.x):void 0,T.y=L.y?Math.max(0,L.y):void 0}if(T.x!==void 0&&T.y!==void 0){const C={id:w,type:"position",position:{...T}};_.push(C)}if(L.width!==void 0&&L.height!==void 0){const C={id:w,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:L.width,height:L.height}};_.push(C)}for(const C of z){const O={...C,type:"position"};_.push(O)}R(_)},onEnd:()=>{const L={id:w,type:"dimensions",resizing:!1};N.getState().triggerNodeChanges([L])}})),b.current.update({controlPosition:M,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:u},keepAspectRatio:f,onResizeStart:h,onResize:y,onResizeEnd:x,shouldResize:d}),()=>{var L;(L=b.current)==null||L.destroy()}},[M,a,l,c,u,f,h,y,x,d]);const I=M.split("-"),E=n===Ge.Line?"borderColor":"backgroundColor",k=s?{...o,[E]:s}:o;return $.jsx("div",{className:te(["react-flow__resize-control","nodrag",...I,n,r]),ref:p,style:k,children:i})}D.memo(bh);var Bi={VITE_USER_NODE_ENV:"development",BASE_URL:"/",MODE:"development",DEV:!0,PROD:!1,SSR:!1};const{useDebugValue:Sh}=Kr,{useSyncExternalStoreWithSelector:Eh}=oi;let Gr=!1;const Nh=e=>e;function Mh(e,t=Nh,n){(Bi?"development":void 0)!=="production"&&n&&!Gr&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Gr=!0);const r=Eh(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Sh(r),r}const qr=e=>{(Bi?"development":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?ii(e):e,n=(r,o)=>Mh(t,r,o);return Object.assign(n,t),n},Ch=e=>e?qr(e):qr,$h=e=>(t,n,r)=>(r.setState=(o,i,...s)=>{const a=typeof o=="function"?Fs(o):o;return t(a,i,...s)},e(r.setState,n,r)),Ih=$h;function Ah(e,t){switch(t){case"ask_question":return{nodeType:"default",data:{title:"Ask me a question"},variableName:`${e}_${t}`};case"email":return{nodeType:"default",data:{title:"What is your email address"},variableName:`${e}_${t}`};case"phone":return{nodeType:"default",data:{title:"What is your phone number"},variableName:`${e}_${t}`};case"username":return{nodeType:"default",data:{title:"Enter your user name"},variableName:`${e}_${t}`};case"address":return{nodeType:"default",data:{title:"What is your address"},variableName:`${e}_${t}`};case"button":return{nodeType:"default",data:{title:"Choose any option"},variableName:`${e}_${t}`,buttonDetails:{buttons:[{name:"option",value:"0",outputId:"output_1"}],variableName:`${e}_${t}(value)`,showImg:!1}};case"result":return{nodeType:"actions",resultNodeDetails:{formula:""},variableName:`${e}_${t}`};case"sendMessage":return{nodeType:"triggers",data:{title:"message"}};case"socialData":return{nodeType:"campaign",webhookData:{isConfigured:!1,variables:[]}};case"segment":return{nodeType:"campaign",audienceData:{name:"",type:"uploadList",listId:"",segmentId:"",scheduleType:"now",scheduleTime:""}};case"liveChat":return{nodeType:"default",data:{title:"Live Chat started..."},liveChatData:{agents:{},useAssigneesAsAgents:!1}};case"sendEmail":return{nodeType:"actions",sendEmailDetails:{emailConfig:"",from:"",to:"",replyTo:"",content:{subject:"",body:""}}};case"sendSMS":return{nodeType:"actions",sendSMSDetails:{smsConfig:"",to:"",smsBody:""}};case"hitApi":{const n=Array.from({length:5},()=>({key:"",value:"",testValue:""}));return{nodeType:"actions",hitApiDetails:{method:"GET",url:"",headers:n,params:n,body:n}}}case"delayAction":return{nodeType:"actions",delayAction:{time:10,timeFormat:"seconds"}};case"pushNotification":return{nodeType:"actions",pushNotification:{pushConfigId:"",title:"",body:""}};case"abTest":return{nodeType:"actions",abTestData:{percent:50,pathA:0,pathB:0}};case"condition":return{nodeType:"actions",conditionData:[{variable:"",value:"",comparison_operator:"EQUAL TO",logical_operator:"AND"}]};case"assignees":return{nodeType:"actions",assigneesData:{logicType:"round_robin",roundRobinData:{},conditionalData:[{assigneeId:"",conditions:[{variable:"",value:""}]},{assigneeId:"",conditions:[]}],sendEmailToAssignee:!0},variableName:`${e}_${t}`};case"whatsApp":return{nodeType:"actions",whatsappDetails:{templateName:"",lang:"",to:"",smsBody:""}};case"envoie":return{nodeType:"actions",templateDetails:{templateId:"",apiKey:""},variableName:`${e}_${t}`};case"openai":return{nodeType:"actions",openAiData:{configId:"",model:"",prompt:"",showParams:!1,params:{}},variableName:`${e}_${t}`};case"linkedIn":return{nodeType:"actions",linkedInData:{nodeType:null,configId:"",name:"",email:"",profileId:"",message:""}};case"sticky":return{nodeType:"default",stickyDetails:{content:""}};default:return{}}}const kh=()=>({nodes:[],edges:[],metaData:{},selectedNodeId:"",nextNodeId:1,variables:{},openConfigModalId:"",segmentVars:[],isSelPanelSCollapse:!0,isWhatsappLoading:!1,nodeErrors:{},leadsData:[],leadsSaveTimer:null,edgeHoverId:null}),Th=(e,t)=>({handleNodesChange:n=>e(r=>{r.nodes=fi(n,r.nodes)}),handleEdgesChange:n=>{e(r=>{r.edges=hi(n,r.edges)})},handleEdgesUpdate:(n,r)=>{e(o=>{o.edges=Tl(n,r,o.edges)})},addNode:(n,r)=>{e(o=>{const i=String(o.nextNodeId);o.nodes.push({id:i,type:n,position:r,data:Ah(i,n)}),o.nextNodeId+=1})},removeNode:n=>{e(r=>{r.nodes=r.nodes.filter(o=>o.id!==n),r.edges=r.edges.filter(o=>o.source!==n&&o.target!==n),r.selectedNodeId=""})},duplicateNode:n=>{e(r=>{const o=r.nodes.find(c=>c.id===n);if(!o)return;const i=String(r.nextNodeId),{type:s,position:a,data:l}=o;r.nodes.push({id:i,type:s,position:{x:a.x,y:a.y+150},data:l}),r.nextNodeId+=1})},selectNode:n=>{e(r=>{r.selectedNodeId=n})},addEdge:n=>{e(r=>{const o={...n,type:"custom",updatable:"target"};r.edges=Fo(o,r.edges)})},removeEdge:n=>{e(r=>{r.edges=r.edges.filter(o=>o.id!==n)})},setMetaData:n=>{e(r=>{Object.assign(r.metaData,n)})},setVariables:n=>{e(r=>{r.variables=Rh(n,r.nodes,r.edges)})},setOpenConfigModalId:n=>{e(r=>{r.openConfigModalId=n})},fetchSegmentData:async n=>{const r=Xn(`/audience/tags?list_id=${n}`),o=Xn(`/audience/leads?list_id=${n}&type=upload`),[i,s]=await Promise.all([r,o]);e(a=>{a.segmentVars=i.data.data,a.leadsData=s.data.data})},updateLeadsData:async(n,r)=>{e(o=>{for(const i of o.leadsData)if(i._id===n){Object.assign(i,r);break}o.leadsSaveTimer&&clearTimeout(o.leadsSaveTimer),o.leadsSaveTimer=setTimeout(()=>{js("/audience/editLeads",t().leadsData)},3e3)})},setIsSelPanelSCollapse:n=>{e(r=>{r.isSelPanelSCollapse=n})},setIsWhatsappLoading:n=>{e(r=>{r.isWhatsappLoading=n})},setNodeErrors:n=>{e(r=>{r.nodeErrors=n})},setCampaignData:n=>{e(r=>{Object.assign(r.nodes[0].data.audienceData,n)})},setEdgeHoverId:n=>{e(r=>{r.edgeHoverId=n})},setNodes:n=>{e(r=>{r.nodes=n})}}),nt=Ch()(Ih((...e)=>({...kh(...e),...Th(...e)}))),Dh=nt.getState(),Yh=()=>nt.setState(Dh,!0),Xh=nt;function Rh(e,t,n){var s;const r=[e],o=new Set,i={};for(;r.length;){const a=r.shift();if(!a)break;for(const l of bl(a,t,n)){if(!l.type||o.has(l.id))continue;const c=Lh(l.id,l.type,l.data);for(const u of c.names){const f=c.category??"node";i[f]||(i[f]=[]),(s=i[f])==null||s.push({id:`${l.id}_${u}`,name:u,type:"string",originNode:{id:l.id,type:l.type}})}r.push(l),o.add(l.id)}}return i}function Lh(e,t,n){var r;switch(t){case"campaign":{const o=nt.getState().metaData.campaignType;return o==="socialData"?{names:n.webhookData.variables.map(i=>i.customName),category:"webhook"}:o==="segment"?{names:nt.getState().segmentVars.map(s=>s.name),category:"audience"}:{names:[]}}case"ask_question":case"email":case"phone":case"username":case"address":case"result":case"assignees":return{names:[n.variableName]};case"button":return{names:[n.variableName,n.buttonDetails.variableName]};case"sendEmail":return{names:[`${e}_email_status`,`${e}_email_opened`,`${e}_email_replied`],category:"email"};case"hitApi":return{names:n.hitApiDetails.variables.map(o=>o.customName),category:"api"};case"linkedIn":{const o=[`${e}_firstName`,`${e}_lastName`,`${e}_location`,`${e}_headline`,`${e}_industry`,`${e}_summary`];return{names:[`${e}_profileId`].concat(((r=n.linkedInData)==null?void 0:r.nodeType)==="visit"?o:[]),category:"linkedIn"}}default:return{names:[]}}}export{Bh as B,Se as C,Hh as E,Lt as H,jh as M,zn as P,Kf as R,Xh as a,Vh as b,Ee as c,Yh as d,Fh as e,fi as f,Lh as g,hi as h,Oh as i,Fo as j,j as k,xi as l,Ph as m,bn as n,Ut as o,At as p,On as u};
//# sourceMappingURL=store-BjiLABx5.js.map
