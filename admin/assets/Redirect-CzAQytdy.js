import{a as l,g as I,u as N,o as P,p as C,r as _,e as A,s as t,d as p,j as E,i as b}from"./index-COdFNi2n.js";function x(){const r=l(),s=I(),i=N(),{provider:u}=P(),[g,w]=C();_.useEffect(()=>{h()},[]);async function h(){var d,c;try{const a=g.get("code");if(!u)throw new Error("Invalid provider");if(!a)throw new Error("Login failed");const m=await A("/auth/login/oauth",{code:a,authProvider:u}),{userData:e,companyData:o,defaultCompany:f,token:n}=m.data.data;t("token",n,1,s==null?void 0:s.PUBLIC_DOMAIN,"/"),t("token",n,1,s==null?void 0:s.PAGE_DOMAIN,"/"),e.sessionCount<1&&(t("onBoarding","true",1,s==null?void 0:s.PUBLIC_DOMAIN,"/"),t(`journey-builder:${e._id}`,"true",2,s==null?void 0:s.PUBLIC_DOMAIN,"/"),t(`journey-dashboard:${e._id}`,"true",2,s==null?void 0:s.PUBLIC_DOMAIN,"/")),r(p.actions.login({userId:e._id,userName:e.userName,userEmail:e.userEmail,userPhone:e.userPhone,sessionCount:e.sessionCount,defaultCompany:f,companyDetails:{_id:o._id,compName:o.compName,userId:o.userId,count:o.count,subDomain:o.subDomain,createdAt:o.createdAt,updatedAt:o.updatedAt}})),i("/dashboard")}catch(a){r(p.actions.setToastPopUp({show:!0,toastType:"error",message:((c=(d=a.response)==null?void 0:d.data)==null?void 0:c.message)??(a==null?void 0:a.message)??"Something went wrong"})),i("/login")}}return E.jsxDEV(b,{},void 0,!1,{fileName:"C:/Users/japba/OneDrive/Desktop/OmniEngage/og-engage-frontend/src/pages/authentication/Redirect.tsx",lineNumber:71,columnNumber:10},this)}export{x as default};
//# sourceMappingURL=Redirect-CzAQytdy.js.map
