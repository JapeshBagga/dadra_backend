{"version":3,"file":"PaymentSummary-FLSqf97h.js","sources":["../../src/hooks/useGetCompany.tsx","../../src/components/layoutElements/PaymentSummary.tsx"],"sourcesContent":["import { axiosGet } from \"@/services/axiosService\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\n\r\nexport default function useGetCompany(){\r\n  return useQuery({\r\n    queryKey: [\"getCompany\"],\r\n    queryFn: async () => {\r\n      const res = await axiosGet(\"users/getCompany\");\r\n      return res;\r\n    },\r\n  });\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { axiosGet, axiosPost } from \"@/services/axiosService\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { userSlice } from \"../../redux/User\";\r\nimport PaymentForm from \"./PaymentForm\";\r\nimport { PlanModals } from \"@/pages/agent/PlanAddonModal\";\r\nimport environment from \"./../../constants/Environment\";\r\nconst environmentData: any = environment();\r\n\r\ninterface Props {\r\n  subscription: any;\r\n  setCheckOutPage: any;\r\n  planCode: any;\r\n  setIsEvent: any;\r\n  setLoading: any;\r\n  isExpired: any;\r\n  price: any;\r\n  addon: any;\r\n  calledFromAgent?: any;\r\n  setShowPlansModal?: React.Dispatch<React.SetStateAction<PlanModals>>;\r\n}\r\n\r\nconst PaymentSummary = ({\r\n  subscription,\r\n  setCheckOutPage,\r\n  planCode,\r\n  setIsEvent,\r\n  setLoading,\r\n  isExpired,\r\n  price,\r\n  addon,\r\n  calledFromAgent = false,\r\n  setShowPlansModal = () => {}\r\n} : Props) => {\r\n  const [paymentPage, setPaymentPage] = useState(false);\r\n  const [smallLoader, setSmallLoader] = useState(false);\r\n  const [usedAddonCost, setUsedAddonCost] = useState<number>(0);\r\n  const [credits, setCredits] = useState<number>(0);\r\n  const [total, setTotal] = useState<number>(0)\r\n\r\n  useEffect(() => {\r\n    fetchSubscription();\r\n  }, []);\r\n\r\n  const fetchSubscription = async () => {\r\n    try {\r\n      const data = { subId: subscription.subscription.subscription_id };\r\n      const res = await axiosPost(\"/payments/retrieve\", data);\r\n      setUsedAddonCost(Number(res.data.usedAddonCost.toFixed(2)));\r\n      setCredits(Number(res.data.credits.toFixed(2)));\r\n      if(price === 220){\r\n        const amount =  (price-(price*15)/100)\r\n        setTotal(amount)\r\n\r\n      }\r\n      // setCurrentItems(res.data.subscription.items.data.length)\r\n    } catch (err) {\r\n      console.log(\"err\");\r\n    }\r\n  };\r\n\r\n  const dispatch = useDispatch();\r\n  const handleForm = async () => {\r\n    calledFromAgent && setShowPlansModal(\"payment\")\r\n    if (subscription.subscription.plan.trial) {\r\n      setPaymentPage(true);\r\n    } else {\r\n      setSmallLoader(true);\r\n      const data = {\r\n        subscriptionId: subscription.subscription.subscription_id,\r\n        customerId: subscription.subscription.customer.customer_id,\r\n        planCode,\r\n      };\r\n      try {\r\n        const res = await axiosPost(\"/payments/upgradePlan\", data);\r\n        if (res.data.message === \"your plan will be updated shortly\") {\r\n          dispatch(\r\n            userSlice.actions.setToastPopUp({\r\n              show: true,\r\n              toastType: \"success\",\r\n              message: res.data.message,\r\n            }),\r\n          );\r\n        }\r\n      } catch (err) {\r\n        console.log(err);\r\n      } finally {\r\n        setCheckOutPage(false);\r\n        setSmallLoader(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setCheckOutPage(false);\r\n    setIsEvent(false);\r\n    setLoading(false);\r\n    calledFromAgent && setShowPlansModal(\"plan\");\r\n  };\r\n\r\n  const handleDate = () => {\r\n    let currentDate = new Date();\r\n    let nextDate = new Date(currentDate);\r\n    if (price === 220) {\r\n      nextDate.setFullYear(nextDate.getFullYear() + 1);\r\n    } else {\r\n      nextDate.setMonth(nextDate.getMonth() + 1);\r\n    }\r\n\r\n    let formattedNextDate = nextDate.toISOString().split(\"T\")[0];\r\n    return formattedNextDate;\r\n  };\r\n\r\n  return (\r\n    <div className=\"pop_upBg\">\r\n {!paymentPage && <div className=\"invoice_addons\">\r\n      <div\r\n          className=\"Cncl\"\r\n          onClick={handleClose}\r\n        >\r\n          <svg\r\n            width=\"10\"\r\n            height=\"10\"\r\n            viewBox=\"0 0 10 10\"\r\n            fill=\"#6D6D6D\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n          >\r\n            <path\r\n              d=\"M10 1.00714L8.99286 0L5 3.99286L1.00714 0L0 1.00714L3.99286 5L0 8.99286L1.00714 10L5 6.00714L8.99286 10L10 8.99286L6.00714 5L10 1.00714Z\"\r\n              fill=\"#6D6D6D\"\r\n            />\r\n          </svg>\r\n        </div>\r\n        <div className=\"invoice_heading\">\r\n          <h1>Plan Summary</h1>\r\n        </div>\r\n        <div className=\"invoice_body\">\r\n       <table className=\"invoice-table\">\r\n        <tr >\r\n          <td>Your new subscription plan</td>\r\n          <td>Plus</td>\r\n        </tr>\r\n        <tr>\r\n          <td> New plan period </td>\r\n          <td>{new Date().toISOString().split(\"T\")[0]} To{\" \"}\r\n          {handleDate()}</td>\r\n        </tr>\r\n        <tr>\r\n        <td>Plan price</td>\r\n        <td>\r\n          {(!environmentData.isAI && price === 220) ? (\r\n            <>\r\n               <span className=\"price\">\r\n                <del>$220.00</del> <span className=\"discounted-price\">$187.00</span> (15% off)\r\n              </span>\r\n            </>\r\n          ) : (\r\n            `$${price}`\r\n          )}\r\n        </td>\r\n\r\n      </tr>\r\n        {credits+usedAddonCost > 0 && <tr>\r\n          <td>Credits left</td>\r\n          <td>${Number(credits+usedAddonCost).toFixed(2)}</td>\r\n        </tr>}\r\n        <tr>\r\n          <td> Sub total</td>\r\n          <td>${ Number(((price === 220 ? total : price) - credits - usedAddonCost)).toFixed(2)}</td>\r\n        </tr>\r\n       </table>\r\n        </div>\r\n      \r\n        <div className=\"invoice-footer flex-cnt\">\r\n          <button type=\"submit\" onClick={handleForm} disabled={smallLoader}>\r\n            {smallLoader ? \"Processing\" : \"Make Payment\"}\r\n          </button>\r\n        </div>\r\n     \r\n     \r\n    </div>}\r\n    {paymentPage && (\r\n          <div className=\"invoice_addons\">\r\n          <PaymentForm\r\n            subscriptionId={subscription.subscription.subscription_id}\r\n            customerId={subscription.subscription.customer.customer_id}\r\n            planCode={planCode}\r\n            isExpired={isExpired}\r\n            price={price === 220 ? total : price}\r\n            createInvoice={false}\r\n            addon={addon}\r\n            handleClose={handleClose}\r\n          />\r\n          </div>\r\n      \r\n        )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentSummary;\r\n"],"names":["useGetCompany","useQuery","axiosGet","environmentData","environment","PaymentSummary","subscription","setCheckOutPage","planCode","setIsEvent","setLoading","isExpired","price","addon","calledFromAgent","setShowPlansModal","paymentPage","setPaymentPage","useState","smallLoader","setSmallLoader","usedAddonCost","setUsedAddonCost","credits","setCredits","total","setTotal","useEffect","fetchSubscription","data","res","axiosPost","amount","dispatch","useDispatch","handleForm","userSlice","err","handleClose","handleDate","currentDate","nextDate","jsxDEV","this","Fragment","PaymentForm"],"mappings":"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"}